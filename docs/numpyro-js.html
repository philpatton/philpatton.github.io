<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Philip T. Patton">
<meta name="dcterms.date" content="2026-01-14">
<meta name="description" content="Estimating survival and abundance with Numpyro">

<title>Jolly-Seber ‚Äì Philip T. Patton</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./numpyro-cjs.html" rel="next">
<link href="./numpyro-occ.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-242a7e6346f5e2fd6d6599311e0369af.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Philip T. Patton</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./notebooks.html" aria-current="page"> 
<span class="menu-text">Code</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./defense.html"> 
<span class="menu-text">Defense</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/philpatton"> 
<span class="menu-text"><i class="fa-brands fa-github" aria-label="github"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com/citations?user=4TUtf04AAAAJ&amp;hl=en&amp;oi=ao"> 
<span class="menu-text"><i class="fa-brands fa-google-scholar" aria-label="google-scholar"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bsky.app/profile/ptpatton.bsky.social"> 
<span class="menu-text"><i class="fa-brands fa-bluesky" aria-label="bluesky"></i></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./numpyro-intro.html">NumPyro</a></li><li class="breadcrumb-item"><a href="./numpyro-js.html">Jolly-Seber</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebooks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">PyMC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pymc-occupancy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Occupancy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pymc-closed-cmr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Closed capture-recapture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pymc-distance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distance sampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pymc-scr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial capture-recapture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pymc-msom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Community occupancy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pymc-cjs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cormack-Jolly-Seber</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pymc-jssa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jolly-Seber</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">NumPyro</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numpyro-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numpyro-occ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamic occupancy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numpyro-js.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Jolly-Seber</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numpyro-cjs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cormack-Jolly-Seber</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numpyro-scr-temp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Open SCR</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#model-definition" id="toc-model-definition" class="nav-link active" data-scroll-target="#model-definition">Model definition</a></li>
  <li><a href="#prior-sensitivity" id="toc-prior-sensitivity" class="nav-link" data-scroll-target="#prior-sensitivity">Prior sensitivity</a>
  <ul class="collapse">
  <li><a href="#schwarz-arnason-esque-prior" id="toc-schwarz-arnason-esque-prior" class="nav-link" data-scroll-target="#schwarz-arnason-esque-prior">Schwarz-Arnason-esque prior</a></li>
  <li><a href="#beta-prior" id="toc-beta-prior" class="nav-link" data-scroll-target="#beta-prior">Beta prior</a></li>
  </ul></li>
  <li><a href="#dipper-dataset" id="toc-dipper-dataset" class="nav-link" data-scroll-target="#dipper-dataset">Dipper dataset</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./numpyro-intro.html">NumPyro</a></li><li class="breadcrumb-item"><a href="./numpyro-js.html">Jolly-Seber</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Jolly-Seber</h1>
</div>

<div>
  <div class="description">
    Estimating survival and abundance with Numpyro
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Philip T. Patton </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Marine Mammal Research Program
          </p>
        <p class="affiliation">
            Hawai ªi Institute of Marine Biology
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 14, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Jolly-Seber models are a form of open-population capture-recapture models that estimate survival and abundance. They do so by estimating recruitment, broadly defined, at every time step. Contrast this with Cormack-Jolly-Seber models, which ignore recruitment to focus on just estimating survival.</p>
<p>There are many parameterizations of the Jolly-Seber model. For example, the Jolly-Seber model can be conceived of as a multi-state model with three states: not yet entered, alive, and dead <span class="citation" data-cites="kery2011">(<a href="#ref-kery2011" role="doc-biblioref">K√©ry and Schaub 2011</a>)</span> (<a href="#fig-diagram" class="quarto-xref">Figure&nbsp;1</a>). Those who have not yet entered, <span class="math inline">\(z_{i,t}=0\)</span>, can be recruited into the population, e.g., be born or immigrate into it, thus having <span class="math inline">\(z_{i, t+1}=1\)</span>. These individuals may be captured with probability <span class="math inline">\(p\)</span>. Then, these individuals might die or immigrate out of the population, thus having <span class="math inline">\(z_{i, t+1}=2\)</span>. Such individuals can never re-enter the population.</p>
<p>This multi-state version of the Jolly-Seber is essentially the same as the restricted occupancy parameterization <span class="citation" data-cites="royle2008">(<a href="#ref-royle2008" role="doc-biblioref">Royle and Dorazio 2008, chap. 10</a>)</span>. As such, the <span class="math inline">\(\gamma\)</span> parameter is a nuisance parameter with no biological meaning <span class="citation" data-cites="kery2011">(<a href="#ref-kery2011" role="doc-biblioref">K√©ry and Schaub 2011</a>)</span> (<a href="#fig-diagram" class="quarto-xref">Figure&nbsp;1</a>). It represents ‚Äúremoval entry probabilities‚Äù <span class="citation" data-cites="kery2011">(<a href="#ref-kery2011" role="doc-biblioref">K√©ry and Schaub 2011</a>)</span>, i.e., the probability that the individual is removed from the superpopulation at time <span class="math inline">\(t\)</span>, which contains <span class="math inline">\(M\)</span> individuals. As such, <span class="math inline">\(\gamma\)</span> tends to grow over time because <span class="math inline">\(M\)</span> is fixed across all periods. In this case, <span class="math inline">\(M\)</span> refers to the size of the augmented dataset, meaning that, as in the <a href="./pymc-closed-cmr.html">closed capture-recapture notebook</a>, we will be augmenting the capture histories with all-zero histories.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-diagram" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<svg width="672" height="480" viewbox="0.00 0.00 389.36 288.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 284)">
<title>js_multistate</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-284 385.36,-284 385.36,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_t</title>
<path fill="none" stroke="black" d="M20,-8C20,-8 80.86,-8 80.86,-8 86.86,-8 92.86,-14 92.86,-20 92.86,-20 92.86,-254 92.86,-254 92.86,-260 86.86,-266 80.86,-266 80.86,-266 20,-266 20,-266 14,-266 8,-260 8,-254 8,-254 8,-20 8,-20 8,-14 14,-8 20,-8"></path>
<text text-anchor="middle" x="50.43" y="-249.4" font-family="Times,serif" font-size="14.00">Time t</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_t1</title>
<path fill="none" stroke="black" d="M143.52,-14C143.52,-14 204.37,-14 204.37,-14 210.37,-14 216.37,-20 216.37,-26 216.37,-26 216.37,-260 216.37,-260 216.37,-266 210.37,-272 204.37,-272 204.37,-272 143.52,-272 143.52,-272 137.52,-272 131.52,-266 131.52,-260 131.52,-260 131.52,-26 131.52,-26 131.52,-20 137.52,-14 143.52,-14"></path>
<text text-anchor="middle" x="173.95" y="-255.4" font-family="Times,serif" font-size="14.00">Time t+1</text>
</g>
<!-- N1 -->
<g id="node1" class="node">
<title>N1</title>
<ellipse fill="#e8f4f8" stroke="black" cx="50.43" cy="-199" rx="34.36" ry="34.36"></ellipse>
<text text-anchor="middle" x="50.43" y="-208.9" font-family="Times,serif" font-size="11.00">Not yet</text>
<text text-anchor="middle" x="50.43" y="-195.7" font-family="Times,serif" font-size="11.00">entered</text>
<text text-anchor="middle" x="50.43" y="-182.5" font-family="Times,serif" font-size="11.00">z=0</text>
</g>
<!-- N2 -->
<g id="node4" class="node">
<title>N2</title>
<ellipse fill="#e8f4f8" stroke="black" cx="173.95" cy="-205" rx="34.36" ry="34.36"></ellipse>
<text text-anchor="middle" x="173.95" y="-214.9" font-family="Times,serif" font-size="11.00">Not yet</text>
<text text-anchor="middle" x="173.95" y="-201.7" font-family="Times,serif" font-size="11.00">entered</text>
<text text-anchor="middle" x="173.95" y="-188.5" font-family="Times,serif" font-size="11.00">z=0</text>
</g>
<!-- N1&#45;&gt;N2 -->
<g id="edge1" class="edge">
<title>N1-&gt;N2</title>
<path fill="none" stroke="black" d="M84.95,-200.66C98.64,-201.33 114.64,-202.12 129.22,-202.84"></path>
<polygon fill="black" stroke="black" points="129.37,-206.35 139.53,-203.35 129.71,-199.36 129.37,-206.35"></polygon>
<text text-anchor="middle" x="112.19" y="-206.2" font-family="Times,serif" font-size="14.00">1-Œ≥</text>
</g>
<!-- A2 -->
<g id="node5" class="node">
<title>A2</title>
<ellipse fill="#7eb6d4" stroke="black" cx="173.95" cy="-124" rx="28.69" ry="28.69"></ellipse>
<text text-anchor="middle" x="173.95" y="-127.3" font-family="Times,serif" font-size="11.00">Alive</text>
<text text-anchor="middle" x="173.95" y="-114.1" font-family="Times,serif" font-size="11.00">z=1</text>
</g>
<!-- N1&#45;&gt;A2 -->
<g id="edge2" class="edge">
<title>N1-&gt;A2</title>
<path fill="none" stroke="black" d="M80.23,-181.23C98.4,-170.01 121.91,-155.5 140.71,-143.89"></path>
<polygon fill="black" stroke="black" points="142.58,-146.86 149.25,-138.62 138.9,-140.9 142.58,-146.86"></polygon>
<text text-anchor="middle" x="112.19" y="-169.2" font-family="Times,serif" font-size="14.00">Œ≥</text>
</g>
<!-- A1 -->
<g id="node2" class="node">
<title>A1</title>
<ellipse fill="#7eb6d4" stroke="black" cx="50.43" cy="-118" rx="28.69" ry="28.69"></ellipse>
<text text-anchor="middle" x="50.43" y="-121.3" font-family="Times,serif" font-size="11.00">Alive</text>
<text text-anchor="middle" x="50.43" y="-108.1" font-family="Times,serif" font-size="11.00">z=1</text>
</g>
<!-- A1&#45;&gt;A2 -->
<g id="edge3" class="edge">
<title>A1-&gt;A2</title>
<path fill="none" stroke="black" d="M79,-119.36C95.51,-120.18 116.73,-121.22 134.83,-122.12"></path>
<polygon fill="black" stroke="black" points="134.9,-125.63 145.06,-122.62 135.24,-118.63 134.9,-125.63"></polygon>
<text text-anchor="middle" x="112.19" y="-125.2" font-family="Times,serif" font-size="14.00">œÜ</text>
</g>
<!-- D2 -->
<g id="node6" class="node">
<title>D2</title>
<ellipse fill="#ed6c69" stroke="black" cx="173.95" cy="-50" rx="27.95" ry="27.95"></ellipse>
<text text-anchor="middle" x="173.95" y="-53.3" font-family="Times,serif" font-size="11.00">Dead</text>
<text text-anchor="middle" x="173.95" y="-40.1" font-family="Times,serif" font-size="11.00">z=2</text>
</g>
<!-- A1&#45;&gt;D2 -->
<g id="edge4" class="edge">
<title>A1-&gt;D2</title>
<path fill="none" stroke="black" d="M75.73,-104.4C94.35,-93.98 120.21,-79.51 140.59,-68.11"></path>
<polygon fill="black" stroke="black" points="142.5,-71.05 149.51,-63.11 139.08,-64.94 142.5,-71.05"></polygon>
<text text-anchor="middle" x="112.19" y="-92.2" font-family="Times,serif" font-size="14.00">1-œÜ</text>
</g>
<!-- D1 -->
<g id="node3" class="node">
<title>D1</title>
<ellipse fill="#ef5350" stroke="black" cx="50.43" cy="-44" rx="27.95" ry="27.95"></ellipse>
<text text-anchor="middle" x="50.43" y="-47.3" font-family="Times,serif" font-size="11.00">Dead</text>
<text text-anchor="middle" x="50.43" y="-34.1" font-family="Times,serif" font-size="11.00">z=2</text>
</g>
<!-- D1&#45;&gt;D2 -->
<g id="edge5" class="edge">
<title>D1-&gt;D2</title>
<path fill="none" stroke="black" d="M78.4,-43.98C91.44,-44.1 107.3,-44.42 121.52,-45.2 126.3,-45.46 131.33,-45.83 136.29,-46.24"></path>
<polygon fill="black" stroke="black" points="136.01,-49.72 146.28,-47.12 136.63,-42.75 136.01,-49.72"></polygon>
<text text-anchor="middle" x="112.19" y="-49.2" font-family="Times,serif" font-size="14.00">1</text>
</g>
<!-- obs -->
<g id="node7" class="node">
<title>obs</title>
<path fill="#c5f6c7" stroke="black" d="M369.36,-142C369.36,-142 257.38,-142 257.38,-142 251.38,-142 245.38,-136 245.38,-130 245.38,-130 245.38,-118 245.38,-118 245.38,-112 251.38,-106 257.38,-106 257.38,-106 369.36,-106 369.36,-106 375.36,-106 381.36,-112 381.36,-118 381.36,-118 381.36,-130 381.36,-130 381.36,-136 375.36,-142 369.36,-142"></path>
<text text-anchor="middle" x="313.37" y="-120.7" font-family="Times,serif" font-size="11.00">y‚Çú ~ Bernoulli(p¬∑ùüô[z=1])</text>
</g>
<!-- A2&#45;&gt;obs -->
<g id="edge6" class="edge">
<title>A2-&gt;obs</title>
<path fill="none" stroke="#1976d2" stroke-dasharray="5,2" d="M202.76,-124C212.28,-124 223.45,-124 234.95,-124"></path>
<polygon fill="#1976d2" stroke="#1976d2" points="235.11,-127.5 245.11,-124 235.11,-120.5 235.11,-127.5"></polygon>
</g>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Jolly-Seber multistate model: recruitment (Œ≥), survival (œÜ), detection (p)
</figcaption>
</figure>
</div>
</div>
</div>
<p>In this notebook, I will primarily analyze simulated data. This is helpful because, as we will see, these models are sensitive to priors on <span class="math inline">\(\gamma\)</span>. The simulation code is a direct translation of the code from <span class="citation" data-cites="kery2011">(<a href="#ref-kery2011" role="doc-biblioref">K√©ry and Schaub 2011, chap. 10</a>)</span>, although I‚Äôve vectorized the operations and leveraged some NumPy tricks, like <code>accummulate()</code>.</p>
<div id="b2b791c6" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">'retina'</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> jax <span class="im">import</span> random</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> jax.scipy.special <span class="im">import</span> expit</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpyro.contrib.control_flow <span class="im">import</span> scan</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpyro.infer <span class="im">import</span> NUTS, MCMC, Predictive</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jax.numpy <span class="im">as</span> jnp</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpyro</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpyro.distributions <span class="im">as</span> dist</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting defaults</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'fivethirtyeight'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.facecolor'</span>] <span class="op">=</span> <span class="st">'white'</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.facecolor'</span>] <span class="op">=</span> <span class="st">'white'</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.spines.left'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.spines.right'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.spines.top'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.spines.bottom'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">"tab10"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># hyperparameters</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">89</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>MAX_ABUNDANCE <span class="op">=</span> <span class="dv">500</span> <span class="co"># size of augmented dipper dataset</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># mcmc hyperparameters</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>CHAIN_COUNT <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>WARMUP_COUNT <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>SAMPLE_COUNT <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation hyperparameters</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>OCCASION_COUNT <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>SUPERPOPULATION_SIZE <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>APPARENT_SURVIVAL <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>INITIAL_PI <span class="op">=</span> <span class="fl">0.34</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>RECAPTURE_RATE <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># make the labels on arviz plots nicer</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>labeller <span class="op">=</span> az.labels.MapLabeller(</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    var_name_map<span class="op">=</span>{<span class="st">"psi"</span>: <span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">psi</span><span class="dv">$</span><span class="vs">"</span>, <span class="st">'gamma'</span>:  <span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">gamma</span><span class="dv">$</span><span class="vs">"</span>, <span class="st">'alpha'</span>: <span class="vs">r'</span><span class="dv">$</span><span class="ch">\a</span><span class="vs">lpha</span><span class="dv">$</span><span class="vs">'</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'epsilon'</span>: <span class="vs">r"</span><span class="dv">$</span><span class="er">\</span><span class="vs">epsilon</span><span class="dv">$</span><span class="vs">"</span>, <span class="st">'p'</span>:  <span class="vs">r"</span><span class="dv">$</span><span class="vs">p</span><span class="dv">$</span><span class="vs">"</span> , <span class="st">'beta'</span>: <span class="vs">r'</span><span class="dv">$\b</span><span class="vs">eta</span><span class="dv">$</span><span class="vs">'</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'phi'</span>: <span class="vs">r'</span><span class="dv">$</span><span class="er">\</span><span class="vs">phi</span><span class="dv">$</span><span class="vs">'</span>, <span class="st">'alpha_t'</span>: <span class="vs">r'</span><span class="dv">$</span><span class="ch">\a</span><span class="vs">lpha_t</span><span class="dv">$</span><span class="vs">'</span>,}</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> augment_history(history):</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Augments a capture histories with all zero histories'''</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    number_encountered, occasion_count <span class="op">=</span> history.shape</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    number_to_augment <span class="op">=</span> MAX_ABUNDANCE <span class="op">-</span> number_encountered</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    all_zero_histories <span class="op">=</span> np.zeros((number_to_augment, occasion_count))</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    y_augmented <span class="op">=</span> np.vstack([history, all_zero_histories])</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y_augmented.astype(np.int32)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_dipper_data():</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Loads and augments the classic dipper dataset'''</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    dipper <span class="op">=</span> np.loadtxt(<span class="st">'dipper.csv'</span>, delimiter<span class="op">=</span><span class="st">','</span>).astype(<span class="bu">int</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    y_augmented <span class="op">=</span> augment_history(dipper)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y_augmented</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sim_js():</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Simulation code ported from Kery and Schaub (2012), Chapter 10"""</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    rng <span class="op">=</span> np.random.default_rng(RANDOM_SEED)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    interval_count <span class="op">=</span> OCCASION_COUNT <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate entry into the population</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    pi_rest <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> INITIAL_PI) <span class="op">/</span> interval_count</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    pi <span class="op">=</span> np.concatenate([[INITIAL_PI], np.full(interval_count, pi_rest)])</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># which occasion did the animal enter in?</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    entry_matrix <span class="op">=</span> rng.multinomial(n<span class="op">=</span><span class="dv">1</span>, pvals<span class="op">=</span>pi, size<span class="op">=</span>SUPERPOPULATION_SIZE)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    entry_occasion <span class="op">=</span> entry_matrix.nonzero()[<span class="dv">1</span>]</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    _, entrant_count <span class="op">=</span> np.unique(entry_occasion, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># zero if the animal has not yet entered and one after it enters</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    entry_trajectory <span class="op">=</span> np.maximum.accumulate(entry_matrix, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># flip coins for survival between occasions</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    survival_draws <span class="op">=</span> rng.binomial(</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>, APPARENT_SURVIVAL, (SUPERPOPULATION_SIZE, interval_count)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add column such that survival between t and t+1 implies alive at t+1</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    survival_draws <span class="op">=</span> np.column_stack([np.ones(SUPERPOPULATION_SIZE), survival_draws])</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ensure that the animal survives until it enters</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    is_yet_to_enter <span class="op">=</span> np.arange(OCCASION_COUNT) <span class="op">&lt;=</span> entry_occasion[:, <span class="va">None</span>]</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    survival_draws[is_yet_to_enter] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># once the survival_draws flips to zero the remaining row stays 0</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    survival_trajectory <span class="op">=</span> np.cumprod(survival_draws, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># animal has entered AND is still alive</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> entry_trajectory <span class="op">*</span> survival_trajectory</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># binary matrix of random possible recaptures</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    capture <span class="op">=</span> rng.binomial(</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>, RECAPTURE_RATE, (SUPERPOPULATION_SIZE, OCCASION_COUNT)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove the non-detected individuals</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    capture_history <span class="op">=</span> state <span class="op">*</span> capture</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    was_captured <span class="op">=</span> capture_history.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    capture_history <span class="op">=</span> capture_history[was_captured]</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># augment the history with nz animals</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    n, _ <span class="op">=</span> capture_history.shape</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    nz <span class="op">=</span> M <span class="op">-</span> n</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    all_zero_history <span class="op">=</span> np.zeros((nz, OCCASION_COUNT))</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    capture_history <span class="op">=</span> np.vstack([capture_history, all_zero_history]).astype(<span class="bu">int</span>)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return a dict with relevant summary stats</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    N_t <span class="op">=</span> state.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>        <span class="st">'capture_history'</span>: capture_history,</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>        <span class="st">'N_t'</span>: N_t,</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>        <span class="st">'B'</span>: entrant_count,</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="model-definition" class="level1">
<h1>Model definition</h1>
<p>The model is very similar to the one described in the <a href="./numpyro-occ.html">dynamic occupancy notebook</a>. The primary difference is that the probabilities for the <span class="math inline">\(z_{i, j}\)</span> states are encoded via the transition probability matrix (<a href="#tbl-tpm" class="quarto-xref">Table&nbsp;1</a>).</p>
<div id="tbl-tpm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tpm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Transition probability matrix in the NumPyro model
</figcaption>
<div aria-describedby="tbl-tpm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 34%">
<col style="width: 22%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">From ‚Üì / To ‚Üí</th>
<th style="text-align: right;">Not yet entered (<span class="math inline">\(z=0\)</span>)</th>
<th style="text-align: right;">Alive (<span class="math inline">\(z=1\)</span>)</th>
<th style="text-align: right;">Dead (<span class="math inline">\(z=2\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Not yet entered</strong> (<span class="math inline">\(z=0\)</span>)</td>
<td style="text-align: right;"><span class="math inline">\(1 - \gamma_t\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\gamma_t\)</span></td>
<td style="text-align: right;"><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Alive</strong> (<span class="math inline">\(z=1\)</span>)</td>
<td style="text-align: right;"><span class="math inline">\(0\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: right;"><span class="math inline">\(1 - \phi\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Dead</strong> (<span class="math inline">\(z=2\)</span>)</td>
<td style="text-align: right;"><span class="math inline">\(0\)</span></td>
<td style="text-align: right;"><span class="math inline">\(0\)</span></td>
<td style="text-align: right;"><span class="math inline">\(1\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Parameterizing the model this way is the easiest way in NumPyro to encode the restriction that dead animals cannot re-enter the population. To match the data-generating process, I allow <span class="math inline">\(\gamma\)</span> to time vary while keeping <span class="math inline">\(\phi\)</span> and <span class="math inline">\(p\)</span> constant across animals and occasions.</p>
<p>The model also shows how to compute derived quantities with NumPyro. Here, I generate estimates for the entry probabilities, <span class="math inline">\(\pi,\)</span> and the overall inclusion probability, <span class="math inline">\(\psi\)</span>. This helps compare with the data generating process in <code>sim_js()</code>, as well as compare with the Schwarz-Arnason (POPAN) formulation of the model.</p>
<p>One principle difference and the multi-state version described in <span class="citation" data-cites="kery2011">(<a href="#ref-kery2011" role="doc-biblioref">K√©ry and Schaub 2011, chap. 10</a>)</span> is that we do not include a dummy occasion of all zeros. This is because we can initialize the <span class="math inline">\(z_{i,0}\)</span> to be <span class="math inline">\(0\)</span> for all individuals, (see <code>z0</code> below). Then, we begin the scan starting at the first occasion in our capture history. As such, we estimate transition from this initial state to the first occasion in our capture history. Contrast this with the <a href="./numpyro-occ.html">dynamic occupancy notebook</a>, where we begin the scan at the second season in the detection data.</p>
<div id="21351a69" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> js_prior1(capture_history):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    super_size, occasion_count <span class="op">=</span> capture_history.shape</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    phi <span class="op">=</span> numpyro.sample(<span class="st">'phi'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> numpyro.sample(<span class="st">'p'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> numpyro.plate(<span class="st">'intervals'</span>, occasion_count):</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        gamma <span class="op">=</span> numpyro.sample(<span class="st">'gamma'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> transition_and_capture(carry, y_current):</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        z_previous, t <span class="op">=</span> carry</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># transition probability matrix</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        trans_probs <span class="op">=</span> jnp.array([</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">1</span> <span class="op">-</span> gamma[t], gamma[t],     <span class="fl">0.0</span>],  <span class="co"># From not yet entered</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            [         <span class="fl">0.0</span>,      phi, <span class="dv">1</span> <span class="op">-</span> phi],  <span class="co"># From alive</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            [         <span class="fl">0.0</span>,      <span class="fl">0.0</span>,     <span class="fl">1.0</span>]   <span class="co"># From dead</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> numpyro.plate(<span class="st">"animals"</span>, super_size, dim<span class="op">=-</span><span class="dv">1</span>):</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># transition probabilities depend on current state</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            mu_z_current <span class="op">=</span> trans_probs[z_previous]</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            z_current <span class="op">=</span> numpyro.sample(</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">"state"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                dist.Categorical(dist.util.clamp_probs(mu_z_current)),</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                infer<span class="op">=</span>{<span class="st">"enumerate"</span>: <span class="st">"parallel"</span>}</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            mu_y_current <span class="op">=</span> jnp.where(z_current <span class="op">==</span> <span class="dv">1</span>, p, <span class="fl">0.0</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            numpyro.sample(</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>                dist.Bernoulli(dist.util.clamp_probs(mu_y_current)),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                obs<span class="op">=</span>y_current</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (z_current, t <span class="op">+</span> <span class="dv">1</span>), <span class="va">None</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># start everyone in the not yet entered state</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    state_init <span class="op">=</span> jnp.zeros(super_size, dtype<span class="op">=</span>jnp.int32)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    scan(</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        transition_and_capture,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>        (state_init, <span class="dv">0</span>),</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>         jnp.swapaxes(capture_history, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate derived parameters</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    qgamma <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> gamma</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># psi is the overall inclusion probability</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    cumulative_qgamma <span class="op">=</span> jnp.concatenate([</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        jnp.array([<span class="fl">1.0</span>]),</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        jnp.cumprod(qgamma[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    cprob <span class="op">=</span> gamma <span class="op">*</span> cumulative_qgamma</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    psi <span class="op">=</span> jnp.<span class="bu">sum</span>(cprob)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    numpyro.deterministic(<span class="st">'psi'</span>, psi)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pi for each occasion</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    numpyro.deterministic(<span class="st">'pi'</span>, cprob <span class="op">/</span> psi )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The downside of coding the model this way in BUGS is that it takes forever to sample. For example, it took <span class="citation" data-cites="kery2011">(<a href="#ref-kery2011" role="doc-biblioref">K√©ry and Schaub 2011</a>)</span> 32 minutes to fit this model to these data with BUGS. In NumPyro, however, we totally sidestep this issue with state enumeration. In fact, this version only takes 11 seconds to sample!</p>
<div id="1c29bcdf" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sim_results <span class="op">=</span> sim_js()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>capture_histories <span class="op">=</span> sim_results[<span class="st">'capture_history'</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>rng_key <span class="op">=</span> random.PRNGKey(RANDOM_SEED)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># specify which sampler you want to use</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>nuts_kernel <span class="op">=</span> NUTS(js_prior1)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># configure the MCMC run</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>mcmc <span class="op">=</span> MCMC(nuts_kernel, num_warmup<span class="op">=</span>WARMUP_COUNT, num_samples<span class="op">=</span>SAMPLE_COUNT,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            num_chains<span class="op">=</span>CHAIN_COUNT)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run the MCMC then inspect the output</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>mcmc.run(rng_key, capture_histories)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>mcmc.print_summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/y8/cz021w550rbb072f7qhxyylh0000gq/T/ipykernel_16237/1877134885.py:10: UserWarning: There are not enough devices to run parallel chains: expected 4 but got 1. Chains will be drawn sequentially. If you are running MCMC in CPU, consider using `numpyro.set_host_device_count(4)` at the beginning of your program. You can double-check how many devices are available in your system using `jax.local_device_count()`.
  mcmc = MCMC(nuts_kernel, num_warmup=WARMUP_COUNT, num_samples=SAMPLE_COUNT,
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   0%|          | 1/1500 [00:00&lt;18:34,  1.34it/s, 1 steps of size 2.34e+00. acc. prob=0.00]warmup:   1%|          | 13/1500 [00:00&lt;01:12, 20.44it/s, 6 steps of size 9.89e-03. acc. prob=0.63]warmup:   1%|‚ñè         | 21/1500 [00:01&lt;01:01, 24.13it/s, 15 steps of size 6.60e-02. acc. prob=0.72]warmup:   2%|‚ñè         | 30/1500 [00:01&lt;00:41, 35.14it/s, 7 steps of size 2.20e-02. acc. prob=0.73] warmup:   3%|‚ñé         | 40/1500 [00:01&lt;00:31, 46.98it/s, 15 steps of size 1.06e-01. acc. prob=0.76]warmup:   3%|‚ñé         | 50/1500 [00:01&lt;00:25, 57.96it/s, 15 steps of size 1.41e-01. acc. prob=0.76]warmup:   4%|‚ñç         | 64/1500 [00:01&lt;00:19, 75.44it/s, 31 steps of size 4.39e-02. acc. prob=0.76]warmup:   5%|‚ñå         | 75/1500 [00:01&lt;00:17, 83.44it/s, 15 steps of size 6.46e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 90/1500 [00:01&lt;00:14, 100.48it/s, 15 steps of size 6.88e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 103/1500 [00:01&lt;00:13, 105.31it/s, 31 steps of size 2.50e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 120/1500 [00:01&lt;00:11, 121.37it/s, 15 steps of size 3.51e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 137/1500 [00:02&lt;00:10, 132.58it/s, 15 steps of size 2.61e-01. acc. prob=0.78]warmup:  10%|‚ñà         | 156/1500 [00:02&lt;00:09, 148.68it/s, 7 steps of size 2.72e-01. acc. prob=0.78] warmup:  12%|‚ñà‚ñè        | 174/1500 [00:02&lt;00:08, 148.26it/s, 47 steps of size 1.95e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 191/1500 [00:02&lt;00:08, 150.01it/s, 31 steps of size 2.52e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 210/1500 [00:02&lt;00:08, 159.52it/s, 7 steps of size 9.45e-01. acc. prob=0.78] warmup:  15%|‚ñà‚ñå        | 227/1500 [00:02&lt;00:08, 154.72it/s, 7 steps of size 3.48e-01. acc. prob=0.78]warmup:  16%|‚ñà‚ñå        | 243/1500 [00:02&lt;00:08, 155.04it/s, 7 steps of size 7.47e-01. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 259/1500 [00:02&lt;00:08, 150.84it/s, 7 steps of size 4.93e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 275/1500 [00:02&lt;00:08, 150.16it/s, 15 steps of size 1.97e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 291/1500 [00:03&lt;00:09, 129.57it/s, 7 steps of size 6.30e-01. acc. prob=0.78] warmup:  20%|‚ñà‚ñà        | 305/1500 [00:03&lt;00:09, 131.81it/s, 7 steps of size 2.67e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà‚ñè       | 322/1500 [00:03&lt;00:08, 136.50it/s, 31 steps of size 2.03e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 338/1500 [00:03&lt;00:08, 141.90it/s, 7 steps of size 5.49e-01. acc. prob=0.78] warmup:  24%|‚ñà‚ñà‚ñé       | 355/1500 [00:03&lt;00:07, 148.84it/s, 7 steps of size 3.87e-01. acc. prob=0.78]warmup:  25%|‚ñà‚ñà‚ñç       | 373/1500 [00:03&lt;00:07, 157.25it/s, 3 steps of size 3.09e-01. acc. prob=0.78]warmup:  26%|‚ñà‚ñà‚ñå       | 390/1500 [00:03&lt;00:06, 159.58it/s, 7 steps of size 5.80e-01. acc. prob=0.79]warmup:  27%|‚ñà‚ñà‚ñã       | 411/1500 [00:03&lt;00:06, 172.13it/s, 7 steps of size 4.86e-01. acc. prob=0.79]warmup:  29%|‚ñà‚ñà‚ñä       | 429/1500 [00:03&lt;00:06, 164.48it/s, 15 steps of size 3.17e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñâ       | 447/1500 [00:04&lt;00:06, 165.35it/s, 15 steps of size 4.05e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà‚ñè      | 469/1500 [00:04&lt;00:05, 173.57it/s, 31 steps of size 3.67e-01. acc. prob=0.79]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 487/1500 [00:04&lt;00:06, 147.75it/s, 15 steps of size 6.31e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 507/1500 [00:04&lt;00:06, 159.46it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  35%|‚ñà‚ñà‚ñà‚ñå      | 528/1500 [00:04&lt;00:05, 169.71it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  36%|‚ñà‚ñà‚ñà‚ñã      | 546/1500 [00:04&lt;00:05, 166.45it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 564/1500 [00:04&lt;00:05, 166.39it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  39%|‚ñà‚ñà‚ñà‚ñä      | 581/1500 [00:04&lt;00:05, 159.49it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 601/1500 [00:04&lt;00:05, 168.99it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 621/1500 [00:05&lt;00:04, 176.21it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 639/1500 [00:05&lt;00:04, 175.58it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 657/1500 [00:05&lt;00:04, 174.23it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 675/1500 [00:05&lt;00:04, 167.70it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 693/1500 [00:05&lt;00:04, 169.63it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 711/1500 [00:05&lt;00:04, 167.10it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 728/1500 [00:05&lt;00:04, 165.97it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 745/1500 [00:05&lt;00:04, 166.65it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 762/1500 [00:05&lt;00:04, 165.81it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 782/1500 [00:06&lt;00:04, 174.60it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 801/1500 [00:06&lt;00:03, 177.57it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 819/1500 [00:06&lt;00:04, 169.88it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 837/1500 [00:06&lt;00:04, 162.85it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 854/1500 [00:06&lt;00:04, 158.11it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 871/1500 [00:06&lt;00:03, 160.99it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 891/1500 [00:06&lt;00:03, 170.70it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 910/1500 [00:06&lt;00:03, 172.41it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 928/1500 [00:06&lt;00:03, 170.21it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 946/1500 [00:07&lt;00:03, 161.35it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 963/1500 [00:07&lt;00:03, 159.26it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 980/1500 [00:07&lt;00:03, 158.69it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 998/1500 [00:07&lt;00:03, 161.69it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1016/1500 [00:07&lt;00:02, 164.13it/s, 23 steps of size 4.16e-01. acc. prob=0.93]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1033/1500 [00:07&lt;00:02, 163.31it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1050/1500 [00:07&lt;00:02, 160.56it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1069/1500 [00:07&lt;00:02, 166.09it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1086/1500 [00:07&lt;00:02, 160.40it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1103/1500 [00:08&lt;00:02, 155.22it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1120/1500 [00:08&lt;00:02, 155.76it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1140/1500 [00:08&lt;00:02, 166.89it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1158/1500 [00:08&lt;00:02, 169.58it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1176/1500 [00:08&lt;00:01, 165.97it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1193/1500 [00:08&lt;00:01, 159.74it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1213/1500 [00:08&lt;00:01, 169.75it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1231/1500 [00:08&lt;00:01, 170.98it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1249/1500 [00:08&lt;00:01, 168.69it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1266/1500 [00:08&lt;00:01, 168.69it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1283/1500 [00:09&lt;00:01, 168.36it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1302/1500 [00:09&lt;00:01, 172.79it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1320/1500 [00:09&lt;00:01, 174.84it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1338/1500 [00:09&lt;00:00, 169.29it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1356/1500 [00:09&lt;00:00, 172.27it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1374/1500 [00:09&lt;00:00, 170.92it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1395/1500 [00:09&lt;00:00, 180.69it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1414/1500 [00:09&lt;00:00, 176.96it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1432/1500 [00:09&lt;00:00, 169.45it/s, 15 steps of size 4.16e-01. acc. prob=0.93]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1451/1500 [00:10&lt;00:00, 173.37it/s, 7 steps of size 4.16e-01. acc. prob=0.93] sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1471/1500 [00:10&lt;00:00, 178.96it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1491/1500 [00:10&lt;00:00, 184.68it/s, 7 steps of size 4.16e-01. acc. prob=0.93]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:10&lt;00:00, 145.53it/s, 7 steps of size 4.16e-01. acc. prob=0.93]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   0%|          | 6/1500 [00:00&lt;00:41, 36.37it/s, 255 steps of size 4.03e-02. acc. prob=0.50]warmup:   1%|          | 10/1500 [00:00&lt;00:44, 33.81it/s, 5 steps of size 1.40e-02. acc. prob=0.59] warmup:   1%|          | 14/1500 [00:00&lt;00:59, 24.88it/s, 39 steps of size 1.64e-01. acc. prob=0.71]warmup:   1%|          | 17/1500 [00:00&lt;01:09, 21.29it/s, 63 steps of size 5.26e-02. acc. prob=0.70]warmup:   1%|‚ñè         | 21/1500 [00:00&lt;01:06, 22.26it/s, 191 steps of size 3.49e-02. acc. prob=0.71]warmup:   2%|‚ñè         | 28/1500 [00:00&lt;00:45, 32.57it/s, 63 steps of size 4.04e-02. acc. prob=0.73] warmup:   3%|‚ñé         | 40/1500 [00:01&lt;00:27, 52.16it/s, 31 steps of size 5.66e-02. acc. prob=0.75]warmup:   4%|‚ñé         | 53/1500 [00:01&lt;00:20, 71.10it/s, 31 steps of size 3.83e-02. acc. prob=0.75]warmup:   4%|‚ñç         | 67/1500 [00:01&lt;00:16, 88.40it/s, 7 steps of size 1.29e-01. acc. prob=0.77] warmup:   6%|‚ñå         | 84/1500 [00:01&lt;00:13, 108.68it/s, 15 steps of size 7.40e-02. acc. prob=0.77]warmup:   6%|‚ñã         | 97/1500 [00:01&lt;00:12, 114.11it/s, 15 steps of size 6.23e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 110/1500 [00:01&lt;00:17, 81.50it/s, 31 steps of size 2.57e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 120/1500 [00:02&lt;00:21, 64.02it/s, 15 steps of size 4.47e-02. acc. prob=0.77]warmup:   9%|‚ñä         | 129/1500 [00:02&lt;00:24, 56.87it/s, 15 steps of size 2.38e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 138/1500 [00:02&lt;00:21, 62.77it/s, 31 steps of size 1.34e-01. acc. prob=0.78]warmup:  10%|‚ñâ         | 146/1500 [00:02&lt;00:20, 64.89it/s, 15 steps of size 1.34e-01. acc. prob=0.78]warmup:  10%|‚ñà         | 155/1500 [00:02&lt;00:19, 69.32it/s, 31 steps of size 2.62e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 166/1500 [00:02&lt;00:16, 78.97it/s, 7 steps of size 1.00e+00. acc. prob=0.78] warmup:  12%|‚ñà‚ñè        | 181/1500 [00:02&lt;00:13, 96.76it/s, 15 steps of size 2.66e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 197/1500 [00:02&lt;00:11, 113.31it/s, 7 steps of size 4.75e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 213/1500 [00:02&lt;00:10, 125.96it/s, 7 steps of size 4.18e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñå        | 232/1500 [00:03&lt;00:08, 143.69it/s, 7 steps of size 1.04e+00. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 257/1500 [00:03&lt;00:07, 173.05it/s, 15 steps of size 6.50e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 275/1500 [00:03&lt;00:09, 128.90it/s, 31 steps of size 2.54e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 290/1500 [00:03&lt;00:09, 132.37it/s, 7 steps of size 7.76e-01. acc. prob=0.78] warmup:  20%|‚ñà‚ñà        | 305/1500 [00:03&lt;00:08, 136.57it/s, 7 steps of size 5.97e-01. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 325/1500 [00:03&lt;00:07, 152.19it/s, 15 steps of size 6.26e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 342/1500 [00:03&lt;00:07, 156.74it/s, 15 steps of size 2.69e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñç       | 363/1500 [00:03&lt;00:06, 171.21it/s, 7 steps of size 4.91e-01. acc. prob=0.78] warmup:  26%|‚ñà‚ñà‚ñå       | 385/1500 [00:03&lt;00:06, 183.36it/s, 15 steps of size 7.05e-01. acc. prob=0.79]warmup:  27%|‚ñà‚ñà‚ñã       | 404/1500 [00:04&lt;00:05, 185.03it/s, 7 steps of size 6.28e-01. acc. prob=0.79] warmup:  29%|‚ñà‚ñà‚ñä       | 428/1500 [00:04&lt;00:05, 199.94it/s, 7 steps of size 5.82e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñâ       | 449/1500 [00:04&lt;00:05, 191.00it/s, 7 steps of size 2.97e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà‚ñè      | 469/1500 [00:04&lt;00:06, 151.32it/s, 7 steps of size 9.70e-02. acc. prob=0.78]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 486/1500 [00:04&lt;00:07, 127.41it/s, 31 steps of size 2.42e-01. acc. prob=0.79]sample:  33%|‚ñà‚ñà‚ñà‚ñé      | 501/1500 [00:04&lt;00:07, 130.12it/s, 15 steps of size 3.53e-01. acc. prob=0.93]sample:  35%|‚ñà‚ñà‚ñà‚ñç      | 518/1500 [00:04&lt;00:07, 137.79it/s, 15 steps of size 3.53e-01. acc. prob=0.91]sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 535/1500 [00:05&lt;00:06, 144.69it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 552/1500 [00:05&lt;00:06, 150.34it/s, 15 steps of size 3.53e-01. acc. prob=0.91]sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 569/1500 [00:05&lt;00:05, 155.18it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  39%|‚ñà‚ñà‚ñà‚ñâ      | 587/1500 [00:05&lt;00:05, 160.36it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 604/1500 [00:05&lt;00:05, 160.32it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 621/1500 [00:05&lt;00:05, 159.42it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 638/1500 [00:05&lt;00:05, 154.68it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 654/1500 [00:05&lt;00:05, 151.43it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 671/1500 [00:05&lt;00:05, 155.17it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 690/1500 [00:05&lt;00:05, 161.59it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 707/1500 [00:06&lt;00:05, 149.88it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 724/1500 [00:06&lt;00:05, 154.13it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 740/1500 [00:06&lt;00:04, 154.99it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 758/1500 [00:06&lt;00:04, 161.63it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 775/1500 [00:06&lt;00:04, 151.70it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 793/1500 [00:06&lt;00:04, 159.27it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 810/1500 [00:06&lt;00:04, 158.85it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 827/1500 [00:06&lt;00:04, 155.70it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 843/1500 [00:06&lt;00:04, 156.65it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 860/1500 [00:07&lt;00:04, 158.08it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 876/1500 [00:07&lt;00:04, 151.15it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 892/1500 [00:07&lt;00:04, 149.98it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 908/1500 [00:07&lt;00:03, 152.23it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 925/1500 [00:07&lt;00:03, 156.26it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 941/1500 [00:07&lt;00:03, 153.80it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 958/1500 [00:07&lt;00:03, 157.86it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 975/1500 [00:07&lt;00:03, 160.43it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 992/1500 [00:07&lt;00:03, 162.55it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1009/1500 [00:08&lt;00:03, 160.25it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1027/1500 [00:08&lt;00:02, 165.58it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1044/1500 [00:08&lt;00:02, 160.18it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1061/1500 [00:08&lt;00:02, 159.94it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1078/1500 [00:08&lt;00:02, 155.87it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1094/1500 [00:08&lt;00:02, 151.50it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1110/1500 [00:08&lt;00:02, 152.60it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1126/1500 [00:08&lt;00:02, 148.74it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1141/1500 [00:08&lt;00:02, 148.80it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1159/1500 [00:09&lt;00:02, 154.42it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1175/1500 [00:09&lt;00:02, 150.74it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1195/1500 [00:09&lt;00:01, 162.93it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1212/1500 [00:09&lt;00:01, 160.18it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1229/1500 [00:09&lt;00:01, 156.64it/s, 11 steps of size 3.53e-01. acc. prob=0.92]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1247/1500 [00:09&lt;00:01, 162.94it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1264/1500 [00:09&lt;00:01, 160.19it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1281/1500 [00:09&lt;00:01, 160.44it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1298/1500 [00:09&lt;00:01, 156.91it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1314/1500 [00:09&lt;00:01, 155.22it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1332/1500 [00:10&lt;00:01, 162.01it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1349/1500 [00:10&lt;00:00, 161.47it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1366/1500 [00:10&lt;00:00, 162.43it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1383/1500 [00:10&lt;00:00, 160.01it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1401/1500 [00:10&lt;00:00, 163.97it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1419/1500 [00:10&lt;00:00, 166.74it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1436/1500 [00:10&lt;00:00, 160.00it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1453/1500 [00:10&lt;00:00, 159.62it/s, 15 steps of size 3.53e-01. acc. prob=0.92]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1470/1500 [00:10&lt;00:00, 158.16it/s, 7 steps of size 3.53e-01. acc. prob=0.92] sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1487/1500 [00:11&lt;00:00, 161.21it/s, 7 steps of size 3.53e-01. acc. prob=0.92]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:11&lt;00:00, 135.03it/s, 7 steps of size 3.53e-01. acc. prob=0.92]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   0%|          | 7/1500 [00:00&lt;00:23, 62.80it/s, 31 steps of size 6.49e-02. acc. prob=0.57]warmup:   1%|          | 17/1500 [00:00&lt;00:18, 82.05it/s, 31 steps of size 4.84e-02. acc. prob=0.70]warmup:   2%|‚ñè         | 30/1500 [00:00&lt;00:14, 101.91it/s, 7 steps of size 2.18e-02. acc. prob=0.73]warmup:   3%|‚ñé         | 41/1500 [00:00&lt;00:15, 95.36it/s, 31 steps of size 5.72e-02. acc. prob=0.75]warmup:   3%|‚ñé         | 51/1500 [00:00&lt;00:15, 90.82it/s, 15 steps of size 8.24e-02. acc. prob=0.76]warmup:   4%|‚ñç         | 61/1500 [00:00&lt;00:16, 86.38it/s, 15 steps of size 8.88e-02. acc. prob=0.76]warmup:   5%|‚ñå         | 75/1500 [00:00&lt;00:14, 99.97it/s, 31 steps of size 4.93e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 89/1500 [00:00&lt;00:12, 110.92it/s, 7 steps of size 1.32e-01. acc. prob=0.77]warmup:   7%|‚ñã         | 101/1500 [00:01&lt;00:13, 102.14it/s, 63 steps of size 1.24e+00. acc. prob=0.78]warmup:   8%|‚ñä         | 117/1500 [00:01&lt;00:12, 114.15it/s, 31 steps of size 2.33e-01. acc. prob=0.77]warmup:   9%|‚ñä         | 129/1500 [00:01&lt;00:11, 114.56it/s, 31 steps of size 3.80e-01. acc. prob=0.78]warmup:  10%|‚ñâ         | 145/1500 [00:01&lt;00:10, 125.83it/s, 15 steps of size 8.55e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 159/1500 [00:01&lt;00:10, 128.57it/s, 7 steps of size 1.15e+00. acc. prob=0.78] warmup:  12%|‚ñà‚ñè        | 173/1500 [00:01&lt;00:11, 120.42it/s, 7 steps of size 5.84e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 189/1500 [00:01&lt;00:10, 129.11it/s, 31 steps of size 2.34e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñé        | 203/1500 [00:01&lt;00:09, 130.76it/s, 15 steps of size 3.96e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 223/1500 [00:01&lt;00:08, 149.22it/s, 7 steps of size 7.47e-01. acc. prob=0.78] warmup:  16%|‚ñà‚ñã        | 247/1500 [00:02&lt;00:07, 173.81it/s, 7 steps of size 2.30e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 267/1500 [00:02&lt;00:06, 179.48it/s, 31 steps of size 1.52e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 286/1500 [00:02&lt;00:07, 154.83it/s, 7 steps of size 1.74e-01. acc. prob=0.78] warmup:  20%|‚ñà‚ñà        | 303/1500 [00:02&lt;00:08, 147.17it/s, 7 steps of size 5.85e-01. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 324/1500 [00:02&lt;00:07, 162.48it/s, 7 steps of size 6.31e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 344/1500 [00:02&lt;00:06, 169.42it/s, 15 steps of size 4.35e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñç       | 362/1500 [00:02&lt;00:07, 160.67it/s, 7 steps of size 7.35e-01. acc. prob=0.79] warmup:  25%|‚ñà‚ñà‚ñå       | 380/1500 [00:02&lt;00:06, 164.83it/s, 7 steps of size 4.07e-01. acc. prob=0.79]warmup:  27%|‚ñà‚ñà‚ñã       | 402/1500 [00:02&lt;00:06, 178.64it/s, 7 steps of size 6.93e-01. acc. prob=0.79]warmup:  28%|‚ñà‚ñà‚ñä       | 425/1500 [00:03&lt;00:05, 192.10it/s, 7 steps of size 9.28e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñà       | 450/1500 [00:03&lt;00:05, 207.70it/s, 7 steps of size 7.67e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà‚ñè      | 472/1500 [00:03&lt;00:05, 197.21it/s, 3 steps of size 1.03e-01. acc. prob=0.79]warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 493/1500 [00:03&lt;00:05, 178.68it/s, 7 steps of size 5.87e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 515/1500 [00:03&lt;00:05, 186.67it/s, 23 steps of size 4.31e-01. acc. prob=0.89]sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 540/1500 [00:03&lt;00:04, 202.66it/s, 7 steps of size 4.31e-01. acc. prob=0.89] sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 561/1500 [00:03&lt;00:04, 200.22it/s, 15 steps of size 4.31e-01. acc. prob=0.89]sample:  39%|‚ñà‚ñà‚ñà‚ñâ      | 582/1500 [00:03&lt;00:04, 196.82it/s, 7 steps of size 4.31e-01. acc. prob=0.90] sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 605/1500 [00:03&lt;00:04, 205.34it/s, 7 steps of size 4.31e-01. acc. prob=0.91]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 627/1500 [00:04&lt;00:04, 207.99it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 648/1500 [00:04&lt;00:04, 206.30it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 670/1500 [00:04&lt;00:03, 208.37it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 692/1500 [00:04&lt;00:03, 208.48it/s, 15 steps of size 4.31e-01. acc. prob=0.89]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 713/1500 [00:04&lt;00:03, 200.38it/s, 7 steps of size 4.31e-01. acc. prob=0.89] sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 735/1500 [00:04&lt;00:03, 203.94it/s, 7 steps of size 4.31e-01. acc. prob=0.89]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 758/1500 [00:04&lt;00:03, 210.61it/s, 7 steps of size 4.31e-01. acc. prob=0.89]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 780/1500 [00:04&lt;00:03, 208.36it/s, 7 steps of size 4.31e-01. acc. prob=0.89]sample:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 801/1500 [00:04&lt;00:03, 207.54it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 824/1500 [00:04&lt;00:03, 212.30it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 846/1500 [00:05&lt;00:03, 212.30it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 869/1500 [00:05&lt;00:02, 214.33it/s, 15 steps of size 4.31e-01. acc. prob=0.90]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 891/1500 [00:05&lt;00:02, 213.88it/s, 7 steps of size 4.31e-01. acc. prob=0.90] sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 913/1500 [00:05&lt;00:02, 208.36it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 937/1500 [00:05&lt;00:02, 215.80it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 959/1500 [00:05&lt;00:02, 213.34it/s, 15 steps of size 4.31e-01. acc. prob=0.90]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 981/1500 [00:05&lt;00:02, 208.42it/s, 7 steps of size 4.31e-01. acc. prob=0.90] sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1008/1500 [00:05&lt;00:02, 223.62it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1032/1500 [00:05&lt;00:02, 226.40it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1055/1500 [00:06&lt;00:01, 222.87it/s, 15 steps of size 4.31e-01. acc. prob=0.90]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1078/1500 [00:06&lt;00:01, 212.20it/s, 7 steps of size 4.31e-01. acc. prob=0.90] sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1100/1500 [00:06&lt;00:01, 212.45it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1122/1500 [00:06&lt;00:01, 210.32it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1144/1500 [00:06&lt;00:01, 208.23it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1165/1500 [00:06&lt;00:01, 200.25it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1188/1500 [00:06&lt;00:01, 206.81it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1210/1500 [00:06&lt;00:01, 206.24it/s, 15 steps of size 4.31e-01. acc. prob=0.90]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1231/1500 [00:06&lt;00:01, 195.13it/s, 15 steps of size 4.31e-01. acc. prob=0.90]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1251/1500 [00:07&lt;00:01, 194.05it/s, 7 steps of size 4.31e-01. acc. prob=0.90] sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1271/1500 [00:07&lt;00:01, 191.31it/s, 15 steps of size 4.31e-01. acc. prob=0.90]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1294/1500 [00:07&lt;00:01, 200.29it/s, 7 steps of size 4.31e-01. acc. prob=0.90] sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1315/1500 [00:07&lt;00:00, 202.10it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1336/1500 [00:07&lt;00:00, 200.63it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1357/1500 [00:07&lt;00:00, 202.58it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1380/1500 [00:07&lt;00:00, 210.07it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1402/1500 [00:07&lt;00:00, 196.62it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1424/1500 [00:07&lt;00:00, 202.65it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1445/1500 [00:07&lt;00:00, 203.92it/s, 7 steps of size 4.31e-01. acc. prob=0.90]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1466/1500 [00:08&lt;00:00, 194.99it/s, 15 steps of size 4.31e-01. acc. prob=0.90]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1491/1500 [00:08&lt;00:00, 208.09it/s, 7 steps of size 4.31e-01. acc. prob=0.90] sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:08&lt;00:00, 181.41it/s, 7 steps of size 4.31e-01. acc. prob=0.90]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   1%|          | 9/1500 [00:00&lt;00:22, 66.27it/s, 63 steps of size 6.91e-02. acc. prob=0.62]warmup:   1%|          | 16/1500 [00:00&lt;00:29, 50.86it/s, 15 steps of size 4.16e-02. acc. prob=0.69]warmup:   2%|‚ñè         | 28/1500 [00:00&lt;00:19, 75.27it/s, 31 steps of size 4.87e-02. acc. prob=0.73]warmup:   3%|‚ñé         | 39/1500 [00:00&lt;00:17, 85.63it/s, 31 steps of size 5.77e-02. acc. prob=0.75]warmup:   3%|‚ñé         | 52/1500 [00:00&lt;00:14, 98.91it/s, 7 steps of size 1.75e-01. acc. prob=0.77] warmup:   4%|‚ñç         | 63/1500 [00:00&lt;00:14, 100.89it/s, 15 steps of size 1.58e-01. acc. prob=0.77]warmup:   5%|‚ñç         | 74/1500 [00:00&lt;00:14, 101.39it/s, 15 steps of size 9.78e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 87/1500 [00:00&lt;00:12, 109.20it/s, 15 steps of size 8.35e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 100/1500 [00:01&lt;00:12, 110.69it/s, 31 steps of size 5.02e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 112/1500 [00:01&lt;00:12, 112.14it/s, 7 steps of size 8.62e-01. acc. prob=0.78] warmup:   8%|‚ñä         | 124/1500 [00:01&lt;00:12, 113.78it/s, 7 steps of size 4.98e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 141/1500 [00:01&lt;00:10, 128.79it/s, 7 steps of size 2.69e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 159/1500 [00:01&lt;00:09, 141.06it/s, 15 steps of size 5.63e-01. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 174/1500 [00:01&lt;00:10, 128.33it/s, 15 steps of size 4.56e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 189/1500 [00:01&lt;00:09, 133.78it/s, 15 steps of size 5.04e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 207/1500 [00:01&lt;00:08, 145.47it/s, 7 steps of size 6.27e-01. acc. prob=0.78] warmup:  15%|‚ñà‚ñå        | 228/1500 [00:01&lt;00:07, 162.20it/s, 15 steps of size 5.17e-01. acc. prob=0.78]warmup:  16%|‚ñà‚ñã        | 246/1500 [00:02&lt;00:07, 166.03it/s, 15 steps of size 5.36e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 263/1500 [00:02&lt;00:07, 166.07it/s, 7 steps of size 8.49e-01. acc. prob=0.78] warmup:  19%|‚ñà‚ñâ        | 283/1500 [00:02&lt;00:07, 168.91it/s, 31 steps of size 4.31e-01. acc. prob=0.78]warmup:  20%|‚ñà‚ñà        | 302/1500 [00:02&lt;00:06, 171.73it/s, 15 steps of size 5.09e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà‚ñè       | 322/1500 [00:02&lt;00:06, 179.04it/s, 7 steps of size 5.91e-01. acc. prob=0.78] warmup:  23%|‚ñà‚ñà‚ñé       | 340/1500 [00:02&lt;00:06, 174.41it/s, 7 steps of size 8.54e-01. acc. prob=0.79]warmup:  24%|‚ñà‚ñà‚ñç       | 360/1500 [00:02&lt;00:06, 180.88it/s, 7 steps of size 5.73e-01. acc. prob=0.79]warmup:  25%|‚ñà‚ñà‚ñå       | 381/1500 [00:02&lt;00:05, 189.05it/s, 15 steps of size 3.42e-01. acc. prob=0.79]warmup:  27%|‚ñà‚ñà‚ñã       | 401/1500 [00:02&lt;00:05, 190.66it/s, 7 steps of size 4.64e-01. acc. prob=0.79] warmup:  28%|‚ñà‚ñà‚ñä       | 425/1500 [00:02&lt;00:05, 204.10it/s, 3 steps of size 3.06e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñâ       | 449/1500 [00:03&lt;00:04, 211.16it/s, 15 steps of size 4.76e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà‚ñè      | 471/1500 [00:03&lt;00:04, 210.18it/s, 3 steps of size 1.33e-01. acc. prob=0.79] warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 493/1500 [00:03&lt;00:05, 183.68it/s, 7 steps of size 4.57e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 517/1500 [00:03&lt;00:04, 196.93it/s, 7 steps of size 4.29e-01. acc. prob=0.95]sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 538/1500 [00:03&lt;00:04, 193.41it/s, 7 steps of size 4.29e-01. acc. prob=0.94]sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 559/1500 [00:03&lt;00:04, 197.59it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  39%|‚ñà‚ñà‚ñà‚ñâ      | 584/1500 [00:03&lt;00:04, 210.61it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 606/1500 [00:03&lt;00:04, 199.03it/s, 15 steps of size 4.29e-01. acc. prob=0.91]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 627/1500 [00:03&lt;00:04, 195.67it/s, 7 steps of size 4.29e-01. acc. prob=0.91] sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 647/1500 [00:04&lt;00:04, 190.80it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 667/1500 [00:04&lt;00:04, 191.96it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 692/1500 [00:04&lt;00:03, 206.72it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 713/1500 [00:04&lt;00:03, 204.30it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 738/1500 [00:04&lt;00:03, 215.70it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 760/1500 [00:04&lt;00:03, 211.80it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 783/1500 [00:04&lt;00:03, 215.44it/s, 11 steps of size 4.29e-01. acc. prob=0.90]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 808/1500 [00:04&lt;00:03, 223.71it/s, 7 steps of size 4.29e-01. acc. prob=0.90] sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 831/1500 [00:04&lt;00:03, 219.57it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 854/1500 [00:05&lt;00:03, 213.44it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 876/1500 [00:05&lt;00:03, 196.48it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 896/1500 [00:05&lt;00:03, 192.27it/s, 3 steps of size 4.29e-01. acc. prob=0.90]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 916/1500 [00:05&lt;00:03, 194.16it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 938/1500 [00:05&lt;00:02, 200.52it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 959/1500 [00:05&lt;00:02, 199.04it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 980/1500 [00:05&lt;00:02, 202.01it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1001/1500 [00:05&lt;00:02, 201.99it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1023/1500 [00:05&lt;00:02, 203.72it/s, 15 steps of size 4.29e-01. acc. prob=0.90]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1048/1500 [00:05&lt;00:02, 216.65it/s, 7 steps of size 4.29e-01. acc. prob=0.91] sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1070/1500 [00:06&lt;00:02, 210.56it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1093/1500 [00:06&lt;00:01, 215.71it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1115/1500 [00:06&lt;00:01, 199.29it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1138/1500 [00:06&lt;00:01, 205.89it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1160/1500 [00:06&lt;00:01, 207.62it/s, 7 steps of size 4.29e-01. acc. prob=0.91]sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1184/1500 [00:06&lt;00:01, 212.55it/s, 15 steps of size 4.29e-01. acc. prob=0.90]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1207/1500 [00:06&lt;00:01, 215.24it/s, 7 steps of size 4.29e-01. acc. prob=0.90] sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1229/1500 [00:06&lt;00:01, 195.12it/s, 11 steps of size 4.29e-01. acc. prob=0.90]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1249/1500 [00:07&lt;00:01, 193.17it/s, 7 steps of size 4.29e-01. acc. prob=0.90] sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1270/1500 [00:07&lt;00:01, 195.66it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1290/1500 [00:07&lt;00:01, 188.47it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1310/1500 [00:07&lt;00:01, 188.45it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1331/1500 [00:07&lt;00:00, 193.53it/s, 15 steps of size 4.29e-01. acc. prob=0.90]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1352/1500 [00:07&lt;00:00, 194.95it/s, 15 steps of size 4.29e-01. acc. prob=0.90]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1374/1500 [00:07&lt;00:00, 200.14it/s, 7 steps of size 4.29e-01. acc. prob=0.90] sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1395/1500 [00:07&lt;00:00, 199.75it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1418/1500 [00:07&lt;00:00, 207.49it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1439/1500 [00:07&lt;00:00, 199.11it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1462/1500 [00:08&lt;00:00, 205.83it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1483/1500 [00:08&lt;00:00, 204.34it/s, 7 steps of size 4.29e-01. acc. prob=0.90]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:08&lt;00:00, 181.87it/s, 15 steps of size 4.29e-01. acc. prob=0.90]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                mean       std    median      5.0%     95.0%     n_eff     r_hat
  gamma[0]      0.14      0.02      0.14      0.11      0.17   2455.08      1.00
  gamma[1]      0.08      0.02      0.08      0.05      0.11   3135.62      1.00
  gamma[2]      0.07      0.02      0.07      0.04      0.10   3373.64      1.00
  gamma[3]      0.06      0.02      0.06      0.03      0.09   2948.77      1.00
  gamma[4]      0.06      0.02      0.06      0.03      0.09   2699.56      1.00
  gamma[5]      0.06      0.02      0.06      0.03      0.09   3743.18      1.00
  gamma[6]      0.05      0.02      0.05      0.02      0.08   3006.14      1.00
         p      0.49      0.04      0.49      0.43      0.55   2253.34      1.00
       phi      0.68      0.03      0.68      0.64      0.73   2632.00      1.00

Number of divergences: 0</code></pre>
</div>
</div>
<div id="cell-fig-trace-ms" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the inference data object for arviz</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> mcmc.get_samples(group_by_chain<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>idata <span class="op">=</span> az.from_dict(samples)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># simplest way to compute the superpopulation size</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">'N'</span>] <span class="op">=</span> idata.posterior[<span class="st">'psi'</span>] <span class="op">*</span> M</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>pi_rest <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> INITIAL_PI) <span class="op">/</span> (OCCASION_COUNT <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>pi <span class="op">=</span> np.concat([[INITIAL_PI], np.full(OCCASION_COUNT <span class="op">-</span> <span class="dv">1</span>, pi_rest)])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># generate traceplots for parameters</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>az.plot_trace(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    idata,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">'N'</span>, <span class="st">'phi'</span>, <span class="st">'p'</span>, <span class="st">'pi'</span>],</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    labeller<span class="op">=</span>labeller,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    lines<span class="op">=</span>[(<span class="st">"phi"</span>, {}, [APPARENT_SURVIVAL]), (<span class="st">"p"</span>, {}, [RECAPTURE_RATE]),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>           (<span class="st">"pi"</span>, {}, pi), (<span class="st">"N"</span>, {}, [SUPERPOPULATION_SIZE])],</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="fig-trace-ms" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trace-ms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="numpyro-js_files/figure-html/fig-trace-ms-output-1.png" width="687" height="678" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trace-ms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Traceplots for multi-state Jolly-Seber model
</figcaption>
</figure>
</div>
</div>
</div>
<p>The model appears to recover the parameters well. While we generated abundance estimates with the <code>psi</code> parameter above, we can also generate them with the posterior predictive distribution.</p>
<div id="cell-fig-n-prior1" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sample_z(model, posterior_samples, capture_history):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Samples the posterior predictive distribution for z given the histories'''</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize the posterior predictive distribution</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    predictive <span class="op">=</span> Predictive(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        model,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        posterior_samples<span class="op">=</span>posterior_samples,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        return_sites<span class="op">=</span>[<span class="st">"state"</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sample z</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    rng_key <span class="op">=</span> random.PRNGKey(RANDOM_SEED)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    latent_samples <span class="op">=</span> predictive(rng_key, capture_history)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> latent_samples[<span class="st">"state"</span>]</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the posterior predictive distribution for N</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> mcmc.get_samples()</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> sample_z(js_prior1, samples, capture_histories)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>ever_alive <span class="op">=</span> z.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>) <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>samples[<span class="st">'N'</span>] <span class="op">=</span> ever_alive.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># create the plot</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>ax.hist(samples[<span class="st">'N'</span>], bins<span class="op">=</span><span class="dv">20</span>, fc<span class="op">=</span><span class="st">'tab:cyan'</span>, ec<span class="op">=</span><span class="st">'w'</span>, alpha<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r'Posterior distribution of </span><span class="dv">$</span><span class="vs">N</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>ax.axvline(SUPERPOPULATION_SIZE, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'tab:pink'</span>, label<span class="op">=</span><span class="st">'Truth'</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>ax.axvline(np.median(samples[<span class="st">'N'</span>]), linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'tab:purple'</span>, label<span class="op">=</span><span class="st">'Median'</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="fig-n-prior1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-n-prior1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="numpyro-js_files/figure-html/fig-n-prior1-output-1.png" width="477" height="381" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-n-prior1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Posterior distribution of <span class="math inline">\(N\)</span> with multi-state Jolly-Seber model.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="prior-sensitivity" class="level1">
<h1>Prior sensitivity</h1>
<p>The above plot shows one potential issue with this parameterization, and the restricted occupancy formulation, namely, that the abundance is sensitive to prior choice. In fact, the prior distribution on abundance is no longer <span class="math inline">\(N \sim \mathrm{DiscreteUniform}(0, M)\)</span>. <span class="citation" data-cites="royle2008">Royle and Dorazio (<a href="#ref-royle2008" role="doc-biblioref">2008</a>)</span> provide two alternative prior specifications for this model. I explore them both below.</p>
<section id="schwarz-arnason-esque-prior" class="level2">
<h2 class="anchored" data-anchor-id="schwarz-arnason-esque-prior">Schwarz-Arnason-esque prior</h2>
<p>This version of the model is very similar to the Schwarz-Arnason parameterization described in <span class="citation" data-cites="royle2008">(<a href="#ref-royle2008" role="doc-biblioref">Royle and Dorazio 2008</a>)</span>. We develop this model by placing a prior distribution on the entry probabilities, <span class="math inline">\(\pi,\)</span> and the inclusion probability, <span class="math inline">\(\psi.\)</span> We can use these values to compute the removal probabilities, <span class="math display">\[
\begin{align}
\gamma_0 &amp;= \psi \pi_0 \\
\gamma_t &amp;= \frac{\psi \pi_t}{\prod_{j=1}^{t-1}(1 - \gamma_j)}, \quad t = 1, \ldots, T
\end{align}
\]</span></p>
<p>One benefit of this approach is that it obviates the need to compute the derived quanitites. Moreover, it allows us to directly compare to the data generating processs.</p>
<div id="4d775927" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> js_prior2(capture_history):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    super_size, occasion_count <span class="op">=</span> capture_history.shape</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    phi <span class="op">=</span> numpyro.sample(<span class="st">'phi'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> numpyro.sample(<span class="st">'p'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># parameterize the  entry probabilities in terms of pi and psi</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    psi <span class="op">=</span> numpyro.sample(<span class="st">'psi'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    pi <span class="op">=</span> numpyro.sample(<span class="st">'pi'</span>, dist.Dirichlet(jnp.ones(occasion_count)))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute the removal probabilities as a function of psi and pi</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> jnp.zeros(occasion_count)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the `vector.at[0].set(1)` notation is jax for `vector[0] = 1`</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> gamma.at[<span class="dv">0</span>].<span class="bu">set</span>(psi <span class="op">*</span> pi[<span class="dv">0</span>])</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, occasion_count):</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        denominator <span class="op">=</span> jnp.prod(<span class="dv">1</span> <span class="op">-</span> gamma[:t])</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        gamma <span class="op">=</span> gamma.at[t].<span class="bu">set</span>(psi <span class="op">*</span> pi[t] <span class="op">/</span> denominator)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> numpyro.deterministic(<span class="st">'gamma'</span>, gamma)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> transition_and_capture(carry, y_current):</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        z_previous, t <span class="op">=</span> carry</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        trans_probs <span class="op">=</span> jnp.array([</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">1</span> <span class="op">-</span> gamma[t], gamma[t], <span class="fl">0.0</span>],  <span class="co"># From not yet entered</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.0</span>, phi, <span class="dv">1</span> <span class="op">-</span> phi],            <span class="co"># From alive</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>]                 <span class="co"># From dead</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> numpyro.plate(<span class="st">"animals"</span>, super_size, dim<span class="op">=-</span><span class="dv">1</span>):</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>            mu_z_current <span class="op">=</span> trans_probs[z_previous]</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>            z_current <span class="op">=</span> numpyro.sample(</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">"state"</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>                dist.Categorical(dist.util.clamp_probs(mu_z_current)),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>                infer<span class="op">=</span>{<span class="st">"enumerate"</span>: <span class="st">"parallel"</span>}</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>            mu_y_current <span class="op">=</span> jnp.where(z_current <span class="op">==</span> <span class="dv">1</span>, p, <span class="fl">0.0</span>)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>            numpyro.sample(</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>                dist.Bernoulli(dist.util.clamp_probs(mu_y_current)),</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>                obs<span class="op">=</span>y_current</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (z_current, t <span class="op">+</span> <span class="dv">1</span>), <span class="va">None</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># start everyone in the not yet entered state</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    state_init <span class="op">=</span> jnp.zeros(super_size, dtype<span class="op">=</span>jnp.int32)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    scan(</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>        transition_and_capture,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>        (state_init, <span class="dv">0</span>),</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>         jnp.swapaxes(capture_history, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="96e78768" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify which sampler you want to use</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>nuts_kernel <span class="op">=</span> NUTS(js_prior2)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># configure the MCMC run</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>mcmc <span class="op">=</span> MCMC(nuts_kernel, num_warmup<span class="op">=</span>WARMUP_COUNT, num_samples<span class="op">=</span>SAMPLE_COUNT,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            num_chains<span class="op">=</span>CHAIN_COUNT)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run the MCMC then inspect the output</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>mcmc.run(rng_key, capture_histories)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>mcmc.print_summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/y8/cz021w550rbb072f7qhxyylh0000gq/T/ipykernel_16237/3518034286.py:5: UserWarning: There are not enough devices to run parallel chains: expected 4 but got 1. Chains will be drawn sequentially. If you are running MCMC in CPU, consider using `numpyro.set_host_device_count(4)` at the beginning of your program. You can double-check how many devices are available in your system using `jax.local_device_count()`.
  mcmc = MCMC(nuts_kernel, num_warmup=WARMUP_COUNT, num_samples=SAMPLE_COUNT,
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   0%|          | 1/1500 [00:00&lt;20:35,  1.21it/s, 1 steps of size 2.34e+00. acc. prob=0.00]warmup:   1%|          | 11/1500 [00:00&lt;01:40, 14.76it/s, 127 steps of size 3.32e-02. acc. prob=0.64]warmup:   1%|‚ñè         | 19/1500 [00:01&lt;01:00, 24.60it/s, 63 steps of size 3.83e-02. acc. prob=0.70] warmup:   2%|‚ñè         | 27/1500 [00:01&lt;00:42, 34.78it/s, 7 steps of size 2.22e-02. acc. prob=0.72] warmup:   2%|‚ñè         | 36/1500 [00:01&lt;00:31, 45.85it/s, 15 steps of size 7.82e-02. acc. prob=0.75]warmup:   3%|‚ñé         | 47/1500 [00:01&lt;00:24, 58.45it/s, 31 steps of size 9.26e-02. acc. prob=0.76]warmup:   4%|‚ñç         | 59/1500 [00:01&lt;00:20, 70.74it/s, 31 steps of size 5.29e-02. acc. prob=0.76]warmup:   5%|‚ñç         | 68/1500 [00:01&lt;00:19, 75.03it/s, 15 steps of size 7.42e-02. acc. prob=0.77]warmup:   5%|‚ñå         | 77/1500 [00:01&lt;00:18, 76.99it/s, 15 steps of size 1.19e-01. acc. prob=0.77]warmup:   6%|‚ñå         | 88/1500 [00:01&lt;00:16, 84.93it/s, 15 steps of size 8.59e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 98/1500 [00:01&lt;00:15, 88.95it/s, 31 steps of size 7.90e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 108/1500 [00:02&lt;00:16, 86.32it/s, 7 steps of size 9.10e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 121/1500 [00:02&lt;00:14, 97.42it/s, 15 steps of size 5.51e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 139/1500 [00:02&lt;00:11, 117.12it/s, 31 steps of size 3.25e-01. acc. prob=0.78]warmup:  10%|‚ñà         | 155/1500 [00:02&lt;00:10, 122.56it/s, 63 steps of size 2.38e-01. acc. prob=0.77]warmup:  11%|‚ñà‚ñè        | 171/1500 [00:02&lt;00:10, 132.80it/s, 7 steps of size 5.82e-01. acc. prob=0.78] warmup:  13%|‚ñà‚ñé        | 188/1500 [00:02&lt;00:09, 142.86it/s, 15 steps of size 4.38e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 207/1500 [00:02&lt;00:08, 155.91it/s, 7 steps of size 7.36e-01. acc. prob=0.78] warmup:  15%|‚ñà‚ñå        | 227/1500 [00:02&lt;00:07, 168.65it/s, 7 steps of size 3.30e-01. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 251/1500 [00:02&lt;00:06, 188.95it/s, 7 steps of size 3.18e+00. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 271/1500 [00:03&lt;00:06, 191.72it/s, 7 steps of size 1.07e+00. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 291/1500 [00:03&lt;00:06, 181.07it/s, 31 steps of size 2.31e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà        | 310/1500 [00:03&lt;00:06, 181.88it/s, 7 steps of size 5.25e-01. acc. prob=0.78] warmup:  22%|‚ñà‚ñà‚ñè       | 333/1500 [00:03&lt;00:06, 194.45it/s, 7 steps of size 5.31e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñé       | 355/1500 [00:03&lt;00:05, 196.70it/s, 15 steps of size 3.91e-01. acc. prob=0.78]warmup:  25%|‚ñà‚ñà‚ñå       | 381/1500 [00:03&lt;00:05, 212.40it/s, 7 steps of size 4.68e-01. acc. prob=0.79] warmup:  27%|‚ñà‚ñà‚ñã       | 405/1500 [00:03&lt;00:04, 219.46it/s, 7 steps of size 3.96e-01. acc. prob=0.79]warmup:  29%|‚ñà‚ñà‚ñä       | 429/1500 [00:03&lt;00:04, 223.25it/s, 15 steps of size 4.80e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñà       | 456/1500 [00:03&lt;00:04, 236.03it/s, 7 steps of size 8.93e-01. acc. prob=0.79] warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 480/1500 [00:04&lt;00:05, 200.56it/s, 3 steps of size 1.34e-01. acc. prob=0.78]sample:  33%|‚ñà‚ñà‚ñà‚ñé      | 502/1500 [00:04&lt;00:05, 185.93it/s, 15 steps of size 4.49e-01. acc. prob=0.92]sample:  35%|‚ñà‚ñà‚ñà‚ñç      | 522/1500 [00:04&lt;00:05, 180.99it/s, 7 steps of size 4.49e-01. acc. prob=0.92] sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 541/1500 [00:04&lt;00:05, 178.51it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 560/1500 [00:04&lt;00:05, 180.69it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  39%|‚ñà‚ñà‚ñà‚ñä      | 579/1500 [00:04&lt;00:05, 173.98it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 600/1500 [00:04&lt;00:04, 183.22it/s, 7 steps of size 4.49e-01. acc. prob=0.92] sample:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 621/1500 [00:04&lt;00:04, 188.26it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 641/1500 [00:04&lt;00:04, 186.61it/s, 7 steps of size 4.49e-01. acc. prob=0.93] sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 660/1500 [00:05&lt;00:04, 184.74it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 680/1500 [00:05&lt;00:04, 187.50it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 699/1500 [00:05&lt;00:04, 178.34it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 717/1500 [00:05&lt;00:04, 166.72it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 735/1500 [00:05&lt;00:04, 169.78it/s, 7 steps of size 4.49e-01. acc. prob=0.93] sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 759/1500 [00:05&lt;00:03, 185.99it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 778/1500 [00:05&lt;00:03, 183.09it/s, 7 steps of size 4.49e-01. acc. prob=0.93] sample:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 798/1500 [00:05&lt;00:03, 187.41it/s, 23 steps of size 4.49e-01. acc. prob=0.93]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 818/1500 [00:05&lt;00:03, 190.13it/s, 7 steps of size 4.49e-01. acc. prob=0.93] sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 839/1500 [00:05&lt;00:03, 194.41it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 859/1500 [00:06&lt;00:03, 192.02it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 879/1500 [00:06&lt;00:03, 187.84it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 898/1500 [00:06&lt;00:03, 188.16it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 921/1500 [00:06&lt;00:02, 198.23it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 941/1500 [00:06&lt;00:02, 194.67it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 961/1500 [00:06&lt;00:02, 185.44it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 980/1500 [00:06&lt;00:02, 178.38it/s, 7 steps of size 4.49e-01. acc. prob=0.93] sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 998/1500 [00:06&lt;00:02, 176.08it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1017/1500 [00:06&lt;00:02, 179.40it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1039/1500 [00:07&lt;00:02, 190.85it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1059/1500 [00:07&lt;00:02, 191.49it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1079/1500 [00:07&lt;00:02, 184.03it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1098/1500 [00:07&lt;00:02, 178.60it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1116/1500 [00:07&lt;00:02, 176.44it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1136/1500 [00:07&lt;00:02, 181.56it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1155/1500 [00:07&lt;00:01, 178.95it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1176/1500 [00:07&lt;00:01, 186.58it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1195/1500 [00:07&lt;00:01, 186.98it/s, 7 steps of size 4.49e-01. acc. prob=0.93] sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1217/1500 [00:08&lt;00:01, 196.18it/s, 7 steps of size 4.49e-01. acc. prob=0.92]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1237/1500 [00:08&lt;00:01, 194.26it/s, 7 steps of size 4.49e-01. acc. prob=0.92]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1257/1500 [00:08&lt;00:01, 187.78it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1276/1500 [00:08&lt;00:01, 187.67it/s, 7 steps of size 4.49e-01. acc. prob=0.93] sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1297/1500 [00:08&lt;00:01, 192.88it/s, 15 steps of size 4.49e-01. acc. prob=0.92]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1317/1500 [00:08&lt;00:01, 180.43it/s, 7 steps of size 4.49e-01. acc. prob=0.92] sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1336/1500 [00:08&lt;00:00, 179.50it/s, 7 steps of size 4.49e-01. acc. prob=0.92]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1355/1500 [00:08&lt;00:00, 179.82it/s, 15 steps of size 4.49e-01. acc. prob=0.92]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1374/1500 [00:08&lt;00:00, 173.84it/s, 7 steps of size 4.49e-01. acc. prob=0.92] sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1393/1500 [00:09&lt;00:00, 178.14it/s, 15 steps of size 4.49e-01. acc. prob=0.92]sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1412/1500 [00:09&lt;00:00, 181.19it/s, 15 steps of size 4.49e-01. acc. prob=0.92]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1431/1500 [00:09&lt;00:00, 175.93it/s, 15 steps of size 4.49e-01. acc. prob=0.92]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1449/1500 [00:09&lt;00:00, 176.53it/s, 7 steps of size 4.49e-01. acc. prob=0.93] sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1467/1500 [00:09&lt;00:00, 177.15it/s, 7 steps of size 4.49e-01. acc. prob=0.93]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1485/1500 [00:09&lt;00:00, 171.66it/s, 15 steps of size 4.49e-01. acc. prob=0.93]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:09&lt;00:00, 155.94it/s, 7 steps of size 4.49e-01. acc. prob=0.93] 
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   1%|          | 11/1500 [00:00&lt;00:20, 74.24it/s, 127 steps of size 2.92e-02. acc. prob=0.63]warmup:   1%|‚ñè         | 19/1500 [00:00&lt;00:22, 65.96it/s, 3 steps of size 1.45e-02. acc. prob=0.69]  warmup:   2%|‚ñè         | 26/1500 [00:00&lt;00:27, 53.56it/s, 15 steps of size 8.78e-02. acc. prob=0.74]warmup:   2%|‚ñè         | 33/1500 [00:00&lt;00:25, 57.37it/s, 31 steps of size 8.12e-02. acc. prob=0.75]warmup:   3%|‚ñé         | 43/1500 [00:00&lt;00:21, 69.11it/s, 31 steps of size 4.69e-02. acc. prob=0.75]warmup:   4%|‚ñé         | 53/1500 [00:00&lt;00:19, 72.69it/s, 63 steps of size 3.54e-02. acc. prob=0.75]warmup:   4%|‚ñç         | 62/1500 [00:00&lt;00:18, 76.46it/s, 15 steps of size 1.02e-01. acc. prob=0.77]warmup:   5%|‚ñç         | 70/1500 [00:00&lt;00:18, 77.31it/s, 31 steps of size 6.13e-02. acc. prob=0.77]warmup:   5%|‚ñå         | 82/1500 [00:01&lt;00:16, 87.08it/s, 31 steps of size 4.61e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 91/1500 [00:01&lt;00:16, 83.58it/s, 15 steps of size 8.46e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 101/1500 [00:01&lt;00:17, 82.10it/s, 63 steps of size 9.17e-01. acc. prob=0.77]warmup:   7%|‚ñã         | 112/1500 [00:01&lt;00:15, 89.33it/s, 23 steps of size 2.13e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 122/1500 [00:01&lt;00:15, 90.63it/s, 7 steps of size 6.02e-01. acc. prob=0.78] warmup:   9%|‚ñâ         | 132/1500 [00:01&lt;00:15, 85.63it/s, 31 steps of size 4.51e-01. acc. prob=0.78]warmup:  10%|‚ñâ         | 148/1500 [00:01&lt;00:12, 105.60it/s, 7 steps of size 6.24e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 162/1500 [00:01&lt;00:11, 113.32it/s, 15 steps of size 5.81e-01. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 179/1500 [00:01&lt;00:10, 128.27it/s, 15 steps of size 2.44e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 193/1500 [00:02&lt;00:10, 128.09it/s, 7 steps of size 3.66e-01. acc. prob=0.78] warmup:  14%|‚ñà‚ñç        | 208/1500 [00:02&lt;00:09, 131.61it/s, 15 steps of size 4.58e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñå        | 227/1500 [00:02&lt;00:08, 146.67it/s, 15 steps of size 6.59e-01. acc. prob=0.78]warmup:  16%|‚ñà‚ñã        | 247/1500 [00:02&lt;00:07, 161.90it/s, 3 steps of size 4.93e-01. acc. prob=0.78] warmup:  18%|‚ñà‚ñä        | 266/1500 [00:02&lt;00:07, 166.99it/s, 15 steps of size 3.21e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 286/1500 [00:02&lt;00:06, 173.67it/s, 15 steps of size 2.08e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà        | 308/1500 [00:02&lt;00:06, 186.03it/s, 7 steps of size 1.10e+00. acc. prob=0.78] warmup:  22%|‚ñà‚ñà‚ñè       | 327/1500 [00:02&lt;00:06, 181.78it/s, 7 steps of size 8.53e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 350/1500 [00:02&lt;00:05, 193.74it/s, 7 steps of size 8.36e-01. acc. prob=0.79]warmup:  25%|‚ñà‚ñà‚ñç       | 374/1500 [00:03&lt;00:05, 205.15it/s, 7 steps of size 7.28e-01. acc. prob=0.79]warmup:  27%|‚ñà‚ñà‚ñã       | 399/1500 [00:03&lt;00:05, 217.57it/s, 7 steps of size 5.73e-01. acc. prob=0.79]warmup:  28%|‚ñà‚ñà‚ñä       | 423/1500 [00:03&lt;00:04, 222.46it/s, 7 steps of size 4.12e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñâ       | 446/1500 [00:03&lt;00:04, 221.95it/s, 7 steps of size 5.23e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà‚ñè      | 469/1500 [00:03&lt;00:04, 214.04it/s, 15 steps of size 4.25e-01. acc. prob=0.79]warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 491/1500 [00:03&lt;00:05, 196.03it/s, 3 steps of size 1.66e-01. acc. prob=0.79] sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 511/1500 [00:03&lt;00:05, 188.94it/s, 15 steps of size 4.74e-01. acc. prob=0.92]sample:  35%|‚ñà‚ñà‚ñà‚ñå      | 532/1500 [00:03&lt;00:05, 192.39it/s, 15 steps of size 4.74e-01. acc. prob=0.92]sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 553/1500 [00:03&lt;00:04, 196.28it/s, 7 steps of size 4.74e-01. acc. prob=0.93] sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 576/1500 [00:04&lt;00:04, 203.84it/s, 7 steps of size 4.74e-01. acc. prob=0.93]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 600/1500 [00:04&lt;00:04, 211.88it/s, 7 steps of size 4.74e-01. acc. prob=0.93]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 624/1500 [00:04&lt;00:04, 218.12it/s, 15 steps of size 4.74e-01. acc. prob=0.93]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 647/1500 [00:04&lt;00:03, 219.51it/s, 7 steps of size 4.74e-01. acc. prob=0.93] sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 670/1500 [00:04&lt;00:03, 219.79it/s, 7 steps of size 4.74e-01. acc. prob=0.93]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 693/1500 [00:04&lt;00:03, 221.80it/s, 7 steps of size 4.74e-01. acc. prob=0.93]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 716/1500 [00:04&lt;00:03, 220.12it/s, 7 steps of size 4.74e-01. acc. prob=0.93]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 739/1500 [00:04&lt;00:03, 213.60it/s, 7 steps of size 4.74e-01. acc. prob=0.93]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 761/1500 [00:04&lt;00:03, 209.45it/s, 15 steps of size 4.74e-01. acc. prob=0.93]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 782/1500 [00:04&lt;00:03, 201.14it/s, 7 steps of size 4.74e-01. acc. prob=0.93] sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 804/1500 [00:05&lt;00:03, 204.12it/s, 15 steps of size 4.74e-01. acc. prob=0.93]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 828/1500 [00:05&lt;00:03, 211.99it/s, 7 steps of size 4.74e-01. acc. prob=0.93] sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 852/1500 [00:05&lt;00:02, 217.82it/s, 7 steps of size 4.74e-01. acc. prob=0.93]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 876/1500 [00:05&lt;00:02, 221.70it/s, 7 steps of size 4.74e-01. acc. prob=0.93]sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 899/1500 [00:05&lt;00:02, 223.42it/s, 15 steps of size 4.74e-01. acc. prob=0.93]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 922/1500 [00:05&lt;00:02, 218.34it/s, 7 steps of size 4.74e-01. acc. prob=0.92] sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 944/1500 [00:05&lt;00:02, 214.38it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 966/1500 [00:05&lt;00:02, 215.85it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 988/1500 [00:05&lt;00:02, 214.17it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1011/1500 [00:06&lt;00:02, 217.78it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1033/1500 [00:06&lt;00:02, 216.94it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1055/1500 [00:06&lt;00:02, 206.96it/s, 15 steps of size 4.74e-01. acc. prob=0.92]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1077/1500 [00:06&lt;00:02, 210.63it/s, 7 steps of size 4.74e-01. acc. prob=0.92] sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1099/1500 [00:06&lt;00:01, 211.74it/s, 3 steps of size 4.74e-01. acc. prob=0.92]sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1121/1500 [00:06&lt;00:01, 208.65it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1143/1500 [00:06&lt;00:01, 209.33it/s, 15 steps of size 4.74e-01. acc. prob=0.92]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1164/1500 [00:06&lt;00:01, 206.85it/s, 7 steps of size 4.74e-01. acc. prob=0.92] sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1188/1500 [00:06&lt;00:01, 211.99it/s, 15 steps of size 4.74e-01. acc. prob=0.92]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1210/1500 [00:06&lt;00:01, 208.97it/s, 7 steps of size 4.74e-01. acc. prob=0.92] sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1234/1500 [00:07&lt;00:01, 216.80it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1256/1500 [00:07&lt;00:01, 217.53it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1278/1500 [00:07&lt;00:01, 212.70it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1302/1500 [00:07&lt;00:00, 218.30it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1325/1500 [00:07&lt;00:00, 216.19it/s, 15 steps of size 4.74e-01. acc. prob=0.92]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1347/1500 [00:07&lt;00:00, 214.33it/s, 7 steps of size 4.74e-01. acc. prob=0.92] sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1369/1500 [00:07&lt;00:00, 210.48it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1391/1500 [00:07&lt;00:00, 210.81it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1413/1500 [00:07&lt;00:00, 202.81it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1437/1500 [00:08&lt;00:00, 212.35it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1461/1500 [00:08&lt;00:00, 219.00it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1484/1500 [00:08&lt;00:00, 220.82it/s, 7 steps of size 4.74e-01. acc. prob=0.92]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:08&lt;00:00, 180.14it/s, 7 steps of size 4.74e-01. acc. prob=0.92]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   1%|          | 15/1500 [00:00&lt;00:09, 149.19it/s, 7 steps of size 1.11e-02. acc. prob=0.65]warmup:   2%|‚ñè         | 30/1500 [00:00&lt;00:23, 61.90it/s, 5 steps of size 5.31e-02. acc. prob=0.74] warmup:   3%|‚ñé         | 42/1500 [00:00&lt;00:19, 75.48it/s, 31 steps of size 9.62e-02. acc. prob=0.76]warmup:   3%|‚ñé         | 52/1500 [00:00&lt;00:18, 78.43it/s, 11 steps of size 3.08e-02. acc. prob=0.75]warmup:   4%|‚ñç         | 62/1500 [00:00&lt;00:17, 80.89it/s, 7 steps of size 7.52e-02. acc. prob=0.76] warmup:   5%|‚ñå         | 77/1500 [00:00&lt;00:14, 98.88it/s, 7 steps of size 7.29e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 89/1500 [00:01&lt;00:14, 97.18it/s, 23 steps of size 6.60e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 100/1500 [00:01&lt;00:14, 97.94it/s, 31 steps of size 1.37e-01. acc. prob=0.78]warmup:   7%|‚ñã         | 112/1500 [00:01&lt;00:13, 103.18it/s, 7 steps of size 4.96e-01. acc. prob=0.78]warmup:   8%|‚ñä         | 125/1500 [00:01&lt;00:13, 101.89it/s, 63 steps of size 1.69e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 138/1500 [00:01&lt;00:13, 103.43it/s, 63 steps of size 1.90e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 159/1500 [00:01&lt;00:10, 126.94it/s, 31 steps of size 2.08e-01. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 173/1500 [00:01&lt;00:10, 130.14it/s, 7 steps of size 1.95e-01. acc. prob=0.78] warmup:  12%|‚ñà‚ñè        | 187/1500 [00:01&lt;00:09, 132.64it/s, 7 steps of size 1.06e+00. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 202/1500 [00:01&lt;00:09, 135.69it/s, 15 steps of size 3.76e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 223/1500 [00:01&lt;00:08, 155.99it/s, 7 steps of size 7.28e-01. acc. prob=0.78] warmup:  16%|‚ñà‚ñã        | 246/1500 [00:02&lt;00:07, 176.50it/s, 7 steps of size 9.87e-01. acc. prob=0.79]warmup:  18%|‚ñà‚ñä        | 267/1500 [00:02&lt;00:06, 183.38it/s, 31 steps of size 2.41e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 286/1500 [00:02&lt;00:06, 175.59it/s, 7 steps of size 5.30e-01. acc. prob=0.78] warmup:  21%|‚ñà‚ñà        | 310/1500 [00:02&lt;00:06, 192.40it/s, 7 steps of size 7.05e-01. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 333/1500 [00:02&lt;00:05, 201.08it/s, 7 steps of size 6.48e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñé       | 355/1500 [00:02&lt;00:05, 205.49it/s, 7 steps of size 8.48e-01. acc. prob=0.79]warmup:  25%|‚ñà‚ñà‚ñå       | 382/1500 [00:02&lt;00:05, 223.00it/s, 7 steps of size 4.41e-01. acc. prob=0.79]warmup:  27%|‚ñà‚ñà‚ñã       | 406/1500 [00:02&lt;00:04, 227.05it/s, 7 steps of size 3.97e-01. acc. prob=0.79]warmup:  29%|‚ñà‚ñà‚ñâ       | 432/1500 [00:02&lt;00:04, 234.69it/s, 7 steps of size 3.75e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñà       | 456/1500 [00:03&lt;00:04, 229.06it/s, 31 steps of size 4.29e-01. acc. prob=0.79]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 479/1500 [00:03&lt;00:05, 201.76it/s, 3 steps of size 1.21e-01. acc. prob=0.79] warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 500/1500 [00:03&lt;00:05, 191.42it/s, 7 steps of size 4.77e-01. acc. prob=0.79]sample:  35%|‚ñà‚ñà‚ñà‚ñç      | 521/1500 [00:03&lt;00:05, 195.38it/s, 15 steps of size 4.77e-01. acc. prob=0.93]sample:  36%|‚ñà‚ñà‚ñà‚ñã      | 544/1500 [00:03&lt;00:04, 202.56it/s, 7 steps of size 4.77e-01. acc. prob=0.93] sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 569/1500 [00:03&lt;00:04, 211.58it/s, 15 steps of size 4.77e-01. acc. prob=0.92]sample:  39%|‚ñà‚ñà‚ñà‚ñâ      | 592/1500 [00:03&lt;00:04, 214.78it/s, 7 steps of size 4.77e-01. acc. prob=0.93] sample:  41%|‚ñà‚ñà‚ñà‚ñà      | 618/1500 [00:03&lt;00:03, 226.22it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 641/1500 [00:03&lt;00:03, 216.31it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 667/1500 [00:04&lt;00:03, 227.23it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 691/1500 [00:04&lt;00:03, 228.46it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 714/1500 [00:04&lt;00:03, 210.32it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 737/1500 [00:04&lt;00:03, 213.22it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 759/1500 [00:04&lt;00:03, 213.30it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 781/1500 [00:04&lt;00:03, 212.97it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 805/1500 [00:04&lt;00:03, 219.43it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 829/1500 [00:04&lt;00:02, 224.36it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 852/1500 [00:04&lt;00:03, 215.30it/s, 15 steps of size 4.77e-01. acc. prob=0.91]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 877/1500 [00:05&lt;00:02, 223.02it/s, 7 steps of size 4.77e-01. acc. prob=0.91] sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 900/1500 [00:05&lt;00:02, 216.94it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 922/1500 [00:05&lt;00:02, 211.38it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 945/1500 [00:05&lt;00:02, 215.63it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 967/1500 [00:05&lt;00:02, 209.11it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 988/1500 [00:05&lt;00:02, 197.03it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1010/1500 [00:05&lt;00:02, 202.01it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1035/1500 [00:05&lt;00:02, 213.34it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1058/1500 [00:05&lt;00:02, 215.59it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1080/1500 [00:06&lt;00:02, 198.76it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1102/1500 [00:06&lt;00:01, 204.50it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1125/1500 [00:06&lt;00:01, 209.27it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1149/1500 [00:06&lt;00:01, 217.09it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1171/1500 [00:06&lt;00:01, 213.31it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1193/1500 [00:06&lt;00:01, 210.78it/s, 7 steps of size 4.77e-01. acc. prob=0.91]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1215/1500 [00:06&lt;00:01, 213.41it/s, 15 steps of size 4.77e-01. acc. prob=0.91]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1237/1500 [00:06&lt;00:01, 213.85it/s, 15 steps of size 4.77e-01. acc. prob=0.91]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1260/1500 [00:06&lt;00:01, 216.05it/s, 7 steps of size 4.77e-01. acc. prob=0.92] sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1283/1500 [00:06&lt;00:00, 220.06it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1307/1500 [00:07&lt;00:00, 223.71it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1332/1500 [00:07&lt;00:00, 229.03it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1355/1500 [00:07&lt;00:00, 224.95it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1378/1500 [00:07&lt;00:00, 221.03it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1401/1500 [00:07&lt;00:00, 220.84it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1425/1500 [00:07&lt;00:00, 224.03it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1449/1500 [00:07&lt;00:00, 227.71it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1472/1500 [00:07&lt;00:00, 227.12it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1497/1500 [00:07&lt;00:00, 233.22it/s, 7 steps of size 4.77e-01. acc. prob=0.92]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:07&lt;00:00, 189.74it/s, 7 steps of size 4.77e-01. acc. prob=0.92]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   1%|          | 11/1500 [00:00&lt;00:17, 87.57it/s, 127 steps of size 2.81e-02. acc. prob=0.63]warmup:   1%|‚ñè         | 20/1500 [00:00&lt;00:29, 50.37it/s, 3 steps of size 1.59e-02. acc. prob=0.69]  warmup:   2%|‚ñè         | 26/1500 [00:00&lt;00:31, 47.08it/s, 3 steps of size 1.76e-02. acc. prob=0.71]warmup:   2%|‚ñè         | 32/1500 [00:00&lt;00:30, 47.59it/s, 63 steps of size 3.05e-02. acc. prob=0.73]warmup:   3%|‚ñé         | 39/1500 [00:00&lt;00:27, 53.64it/s, 31 steps of size 9.05e-02. acc. prob=0.75]warmup:   3%|‚ñé         | 50/1500 [00:00&lt;00:21, 68.44it/s, 15 steps of size 5.68e-02. acc. prob=0.76]warmup:   4%|‚ñç         | 60/1500 [00:00&lt;00:19, 75.62it/s, 15 steps of size 1.33e-01. acc. prob=0.77]warmup:   5%|‚ñç         | 69/1500 [00:01&lt;00:18, 78.95it/s, 7 steps of size 1.36e-01. acc. prob=0.77] warmup:   5%|‚ñå         | 78/1500 [00:01&lt;00:17, 81.78it/s, 63 steps of size 4.41e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 88/1500 [00:01&lt;00:16, 85.88it/s, 31 steps of size 8.00e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 99/1500 [00:01&lt;00:15, 91.51it/s, 15 steps of size 1.24e-01. acc. prob=0.78]warmup:   7%|‚ñã         | 109/1500 [00:01&lt;00:16, 85.70it/s, 3 steps of size 8.96e-01. acc. prob=0.78]warmup:   8%|‚ñä         | 122/1500 [00:01&lt;00:14, 94.42it/s, 31 steps of size 2.79e-01. acc. prob=0.77]warmup:   9%|‚ñâ         | 139/1500 [00:01&lt;00:12, 111.85it/s, 31 steps of size 3.08e-01. acc. prob=0.78]warmup:  10%|‚ñà         | 152/1500 [00:01&lt;00:11, 116.69it/s, 1 steps of size 8.43e-01. acc. prob=0.78] warmup:  11%|‚ñà‚ñè        | 172/1500 [00:01&lt;00:09, 136.41it/s, 31 steps of size 2.09e-01. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 186/1500 [00:02&lt;00:09, 135.26it/s, 7 steps of size 2.39e-01. acc. prob=0.78] warmup:  13%|‚ñà‚ñé        | 202/1500 [00:02&lt;00:09, 141.41it/s, 15 steps of size 2.70e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 220/1500 [00:02&lt;00:08, 149.86it/s, 15 steps of size 4.50e-01. acc. prob=0.78]warmup:  16%|‚ñà‚ñå        | 239/1500 [00:02&lt;00:07, 160.57it/s, 7 steps of size 4.56e-01. acc. prob=0.78] warmup:  17%|‚ñà‚ñã        | 259/1500 [00:02&lt;00:07, 171.97it/s, 15 steps of size 8.63e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñä        | 279/1500 [00:02&lt;00:07, 173.92it/s, 31 steps of size 2.00e-01. acc. prob=0.78]warmup:  20%|‚ñà‚ñà        | 300/1500 [00:02&lt;00:06, 181.39it/s, 15 steps of size 5.44e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà‚ñè       | 319/1500 [00:02&lt;00:06, 175.22it/s, 15 steps of size 4.61e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 338/1500 [00:02&lt;00:06, 177.37it/s, 7 steps of size 4.04e-01. acc. prob=0.78] warmup:  24%|‚ñà‚ñà‚ñç       | 362/1500 [00:02&lt;00:05, 194.38it/s, 15 steps of size 3.62e-01. acc. prob=0.78]warmup:  26%|‚ñà‚ñà‚ñå       | 386/1500 [00:03&lt;00:05, 207.24it/s, 7 steps of size 4.48e-01. acc. prob=0.79] warmup:  27%|‚ñà‚ñà‚ñã       | 410/1500 [00:03&lt;00:05, 215.82it/s, 7 steps of size 6.50e-01. acc. prob=0.79]warmup:  29%|‚ñà‚ñà‚ñâ       | 432/1500 [00:03&lt;00:04, 216.90it/s, 15 steps of size 5.39e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñà       | 455/1500 [00:03&lt;00:04, 216.06it/s, 31 steps of size 2.96e-01. acc. prob=0.79]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 477/1500 [00:03&lt;00:05, 196.43it/s, 15 steps of size 3.89e-01. acc. prob=0.79]warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 498/1500 [00:03&lt;00:05, 183.11it/s, 31 steps of size 2.38e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 517/1500 [00:03&lt;00:05, 184.47it/s, 7 steps of size 4.29e-01. acc. prob=0.96] sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 536/1500 [00:03&lt;00:05, 181.04it/s, 7 steps of size 4.29e-01. acc. prob=0.94]sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 560/1500 [00:03&lt;00:04, 195.40it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  39%|‚ñà‚ñà‚ñà‚ñä      | 580/1500 [00:04&lt;00:04, 196.36it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 602/1500 [00:04&lt;00:04, 201.93it/s, 15 steps of size 4.29e-01. acc. prob=0.93]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 623/1500 [00:04&lt;00:04, 196.69it/s, 15 steps of size 4.29e-01. acc. prob=0.93]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 643/1500 [00:04&lt;00:04, 194.11it/s, 7 steps of size 4.29e-01. acc. prob=0.93] sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 663/1500 [00:04&lt;00:04, 191.82it/s, 7 steps of size 4.29e-01. acc. prob=0.92]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 683/1500 [00:04&lt;00:04, 186.98it/s, 15 steps of size 4.29e-01. acc. prob=0.92]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 703/1500 [00:04&lt;00:04, 189.12it/s, 7 steps of size 4.29e-01. acc. prob=0.93] sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 724/1500 [00:04&lt;00:04, 193.10it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 744/1500 [00:04&lt;00:03, 191.29it/s, 15 steps of size 4.29e-01. acc. prob=0.92]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 764/1500 [00:05&lt;00:03, 189.67it/s, 7 steps of size 4.29e-01. acc. prob=0.93] sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 783/1500 [00:05&lt;00:03, 186.65it/s, 7 steps of size 4.29e-01. acc. prob=0.92]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 803/1500 [00:05&lt;00:03, 190.18it/s, 7 steps of size 4.29e-01. acc. prob=0.92]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 823/1500 [00:05&lt;00:03, 182.23it/s, 3 steps of size 4.29e-01. acc. prob=0.92]sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 843/1500 [00:05&lt;00:03, 186.87it/s, 7 steps of size 4.29e-01. acc. prob=0.92]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 862/1500 [00:05&lt;00:03, 187.32it/s, 7 steps of size 4.29e-01. acc. prob=0.92]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 882/1500 [00:05&lt;00:03, 188.34it/s, 15 steps of size 4.29e-01. acc. prob=0.92]sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 904/1500 [00:05&lt;00:03, 195.51it/s, 7 steps of size 4.29e-01. acc. prob=0.92] sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 924/1500 [00:05&lt;00:03, 190.98it/s, 7 steps of size 4.29e-01. acc. prob=0.92]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 944/1500 [00:06&lt;00:02, 188.56it/s, 15 steps of size 4.29e-01. acc. prob=0.92]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 964/1500 [00:06&lt;00:02, 191.65it/s, 7 steps of size 4.29e-01. acc. prob=0.93] sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 988/1500 [00:06&lt;00:02, 201.32it/s, 15 steps of size 4.29e-01. acc. prob=0.93]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1009/1500 [00:06&lt;00:02, 187.97it/s, 23 steps of size 4.29e-01. acc. prob=0.93]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1029/1500 [00:06&lt;00:02, 191.06it/s, 7 steps of size 4.29e-01. acc. prob=0.92] sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1050/1500 [00:06&lt;00:02, 196.40it/s, 7 steps of size 4.29e-01. acc. prob=0.92]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1070/1500 [00:06&lt;00:02, 194.75it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1090/1500 [00:06&lt;00:02, 193.50it/s, 15 steps of size 4.29e-01. acc. prob=0.93]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1110/1500 [00:06&lt;00:02, 178.94it/s, 7 steps of size 4.29e-01. acc. prob=0.93] sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1129/1500 [00:06&lt;00:02, 179.50it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1148/1500 [00:07&lt;00:02, 173.19it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1167/1500 [00:07&lt;00:01, 177.34it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1187/1500 [00:07&lt;00:01, 181.21it/s, 15 steps of size 4.29e-01. acc. prob=0.92]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1209/1500 [00:07&lt;00:01, 190.09it/s, 15 steps of size 4.29e-01. acc. prob=0.92]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1232/1500 [00:07&lt;00:01, 199.37it/s, 7 steps of size 4.29e-01. acc. prob=0.92] sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1254/1500 [00:07&lt;00:01, 203.26it/s, 7 steps of size 4.29e-01. acc. prob=0.92]sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1275/1500 [00:07&lt;00:01, 202.76it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1296/1500 [00:07&lt;00:01, 201.93it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1317/1500 [00:07&lt;00:00, 197.90it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1337/1500 [00:08&lt;00:00, 193.20it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1358/1500 [00:08&lt;00:00, 197.59it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1378/1500 [00:08&lt;00:00, 190.06it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1402/1500 [00:08&lt;00:00, 203.46it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1424/1500 [00:08&lt;00:00, 205.21it/s, 15 steps of size 4.29e-01. acc. prob=0.93]sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1445/1500 [00:08&lt;00:00, 203.69it/s, 7 steps of size 4.29e-01. acc. prob=0.93] sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1466/1500 [00:08&lt;00:00, 203.39it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1487/1500 [00:08&lt;00:00, 198.29it/s, 7 steps of size 4.29e-01. acc. prob=0.93]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:08&lt;00:00, 169.34it/s, 7 steps of size 4.29e-01. acc. prob=0.93]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                mean       std    median      5.0%     95.0%     n_eff     r_hat
         p      0.50      0.04      0.50      0.44      0.56   2474.72      1.00
       phi      0.68      0.03      0.68      0.64      0.73   3390.42      1.00
     pi[0]      0.33      0.04      0.33      0.26      0.39   3629.21      1.00
     pi[1]      0.16      0.04      0.16      0.10      0.23   3565.42      1.00
     pi[2]      0.13      0.03      0.13      0.07      0.18   3334.39      1.00
     pi[3]      0.11      0.03      0.11      0.06      0.16   3405.33      1.00
     pi[4]      0.10      0.03      0.10      0.06      0.15   3405.02      1.00
     pi[5]      0.10      0.03      0.10      0.05      0.15   4048.82      1.00
     pi[6]      0.07      0.03      0.07      0.03      0.11   4412.08      1.00
       psi      0.40      0.02      0.40      0.36      0.44   3840.84      1.00

Number of divergences: 0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<div id="cell-fig-n-prior2" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the posterior predictive distribution for N</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> mcmc.get_samples()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> sample_z(js_prior2, samples, capture_histories)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ever_alive <span class="op">=</span> z.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>) <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>samples[<span class="st">'N'</span>] <span class="op">=</span> ever_alive.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create the plot</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>ax.hist(samples[<span class="st">'N'</span>], bins<span class="op">=</span><span class="dv">20</span>, fc<span class="op">=</span><span class="st">'tab:cyan'</span>, ec<span class="op">=</span><span class="st">'w'</span>, alpha<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r'Posterior distribution of </span><span class="dv">$</span><span class="vs">N</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>ax.axvline(SUPERPOPULATION_SIZE, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'tab:pink'</span>, label<span class="op">=</span><span class="st">'Truth'</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>ax.axvline(np.median(samples[<span class="st">'N'</span>]), linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'tab:purple'</span>, label<span class="op">=</span><span class="st">'Median'</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="fig-n-prior2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-n-prior2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="numpyro-js_files/figure-html/fig-n-prior2-output-1.png" width="477" height="381" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-n-prior2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Posterior distribution of <span class="math inline">\(N\)</span> with priors on <span class="math inline">\(\pi\)</span> and <span class="math inline">\(\psi\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>The resulting estimate of <span class="math inline">\(N\)</span> is much closer to the true superpopulation size than the original version with a uniform prior on <span class="math inline">\(\gamma.\)</span> One potential downside of this approach is that it requires some familiarity with the relationships between the Schwarz-Arnason parameterizations and the restricted occupancy parameterizations of the Jolly-Seber model.</p>
</section>
<section id="beta-prior" class="level2">
<h2 class="anchored" data-anchor-id="beta-prior">Beta prior</h2>
<p>An easier alternative is to approximate the above prior. As such, we try to approximate the situation where half of all animal in <span class="math inline">\(M\)</span> are recruited, and each of these is equally likely to be recruited during <span class="math inline">\(t\)</span>. So when <span class="math inline">\(T=7\)</span>, we hope that <span class="math inline">\(1/14\)</span> of all individuals are allocated to each time step. To do so, we set a Beta prior, <span class="math inline">\(\gamma_t \sim \mathrm{Beta}(a_t, b_t),\)</span> where <span class="math inline">\(a_t = S/(14-(t-1))\)</span> and <span class="math inline">\(b_t = S - a_t.\)</span> <span class="citation" data-cites="royle2008">Royle and Dorazio (<a href="#ref-royle2008" role="doc-biblioref">2008</a>)</span> recommend setting <span class="math inline">\(S=1.5\)</span>.</p>
<div id="88bef868" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> js_prior3(capture_history):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    super_size, occasion_count <span class="op">=</span> capture_history.shape</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    phi <span class="op">=</span> numpyro.sample(<span class="st">'phi'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> numpyro.sample(<span class="st">'p'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># approximate the situation where half of all individuals are allocated</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># to each time step</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.arange(<span class="dv">1</span>, occasion_count <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> occasion_count <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    a_t <span class="op">=</span> S <span class="op">/</span> (C <span class="op">-</span> (t <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    b_t <span class="op">=</span> S <span class="op">-</span> a_t</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> numpyro.plate(<span class="st">'occasions'</span>, occasion_count):</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        gamma <span class="op">=</span> numpyro.sample(<span class="st">'gamma'</span>, dist.Beta(a_t, b_t))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> transition_and_capture(carry, y_current):</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        z_previous, t <span class="op">=</span> carry</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>        trans_probs <span class="op">=</span> jnp.array([</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">1</span> <span class="op">-</span> gamma[t], gamma[t], <span class="fl">0.0</span>],  <span class="co"># From not yet entered</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.0</span>, phi, <span class="dv">1</span> <span class="op">-</span> phi],            <span class="co"># From alive</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>]                 <span class="co"># From dead</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> numpyro.plate(<span class="st">"animals"</span>, super_size, dim<span class="op">=-</span><span class="dv">1</span>):</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>            mu_z_current <span class="op">=</span> trans_probs[z_previous]</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>            z_current <span class="op">=</span> numpyro.sample(</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">"state"</span>,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>                dist.Categorical(dist.util.clamp_probs(mu_z_current)),</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>                infer<span class="op">=</span>{<span class="st">"enumerate"</span>: <span class="st">"parallel"</span>}</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>            mu_y_current <span class="op">=</span> jnp.where(z_current <span class="op">==</span> <span class="dv">1</span>, p, <span class="fl">0.0</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>            numpyro.sample(</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>                dist.Bernoulli(dist.util.clamp_probs(mu_y_current)),</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>                obs<span class="op">=</span>y_current</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (z_current, t <span class="op">+</span> <span class="dv">1</span>), <span class="va">None</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># start everyone in the not yet entered state</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    state_init <span class="op">=</span> jnp.zeros(super_size, dtype<span class="op">=</span>jnp.int32)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    scan(</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>        transition_and_capture,</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>        (state_init, <span class="dv">0</span>),</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>         jnp.swapaxes(capture_history, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="90ce03f4" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify which sampler you want to use</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>nuts_kernel <span class="op">=</span> NUTS(js_prior3)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># configure the MCMC run</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>mcmc <span class="op">=</span> MCMC(nuts_kernel, num_warmup<span class="op">=</span>WARMUP_COUNT, num_samples<span class="op">=</span>SAMPLE_COUNT,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>            num_chains<span class="op">=</span>CHAIN_COUNT)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run the MCMC then inspect the output</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>mcmc.run(rng_key, capture_histories)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>mcmc.print_summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/y8/cz021w550rbb072f7qhxyylh0000gq/T/ipykernel_16237/3629401454.py:5: UserWarning: There are not enough devices to run parallel chains: expected 4 but got 1. Chains will be drawn sequentially. If you are running MCMC in CPU, consider using `numpyro.set_host_device_count(4)` at the beginning of your program. You can double-check how many devices are available in your system using `jax.local_device_count()`.
  mcmc = MCMC(nuts_kernel, num_warmup=WARMUP_COUNT, num_samples=SAMPLE_COUNT,
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   0%|          | 1/1500 [00:00&lt;16:45,  1.49it/s, 1 steps of size 2.34e+00. acc. prob=0.00]warmup:   1%|          | 13/1500 [00:00&lt;01:07, 22.17it/s, 7 steps of size 9.86e-03. acc. prob=0.63]warmup:   1%|‚ñè         | 20/1500 [00:00&lt;00:58, 25.41it/s, 63 steps of size 3.40e-02. acc. prob=0.70]warmup:   2%|‚ñè         | 29/1500 [00:01&lt;00:39, 36.99it/s, 15 steps of size 1.04e-01. acc. prob=0.74]warmup:   2%|‚ñè         | 36/1500 [00:01&lt;00:34, 42.80it/s, 63 steps of size 6.29e-02. acc. prob=0.75]warmup:   3%|‚ñé         | 47/1500 [00:01&lt;00:25, 57.55it/s, 31 steps of size 4.41e-02. acc. prob=0.75]warmup:   4%|‚ñé         | 56/1500 [00:01&lt;00:22, 63.67it/s, 31 steps of size 7.46e-02. acc. prob=0.76]warmup:   5%|‚ñç         | 70/1500 [00:01&lt;00:18, 78.47it/s, 47 steps of size 5.66e-02. acc. prob=0.76]warmup:   6%|‚ñå         | 86/1500 [00:01&lt;00:14, 98.25it/s, 7 steps of size 4.04e-02. acc. prob=0.77] warmup:   7%|‚ñã         | 98/1500 [00:01&lt;00:13, 100.16it/s, 15 steps of size 1.09e-01. acc. prob=0.77]warmup:   7%|‚ñã         | 112/1500 [00:01&lt;00:12, 109.86it/s, 7 steps of size 4.14e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 126/1500 [00:01&lt;00:11, 116.35it/s, 15 steps of size 7.32e-01. acc. prob=0.78]warmup:  10%|‚ñâ         | 145/1500 [00:02&lt;00:10, 134.67it/s, 15 steps of size 5.57e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 162/1500 [00:02&lt;00:09, 142.87it/s, 31 steps of size 3.35e-01. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 177/1500 [00:02&lt;00:09, 141.95it/s, 15 steps of size 4.42e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 192/1500 [00:02&lt;00:09, 144.05it/s, 15 steps of size 4.35e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 213/1500 [00:02&lt;00:07, 162.68it/s, 7 steps of size 5.66e-01. acc. prob=0.78] warmup:  15%|‚ñà‚ñå        | 230/1500 [00:02&lt;00:08, 157.57it/s, 7 steps of size 9.50e-01. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 248/1500 [00:02&lt;00:07, 162.69it/s, 7 steps of size 2.54e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 265/1500 [00:03&lt;00:11, 105.36it/s, 63 steps of size 7.86e-02. acc. prob=0.78]warmup:  19%|‚ñà‚ñä        | 279/1500 [00:03&lt;00:15, 80.35it/s, 31 steps of size 1.84e-01. acc. prob=0.78] warmup:  19%|‚ñà‚ñâ        | 290/1500 [00:03&lt;00:17, 67.39it/s, 31 steps of size 1.88e-01. acc. prob=0.78]warmup:  20%|‚ñà‚ñâ        | 299/1500 [00:03&lt;00:20, 57.43it/s, 14 steps of size 1.35e-01. acc. prob=0.78]warmup:  20%|‚ñà‚ñà        | 307/1500 [00:03&lt;00:21, 56.51it/s, 127 steps of size 5.00e-02. acc. prob=0.78]warmup:  21%|‚ñà‚ñà        | 314/1500 [00:04&lt;00:22, 53.25it/s, 15 steps of size 2.04e-01. acc. prob=0.78] warmup:  21%|‚ñà‚ñà‚ñè       | 320/1500 [00:04&lt;00:23, 49.92it/s, 31 steps of size 8.14e-02. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 326/1500 [00:04&lt;00:23, 50.30it/s, 31 steps of size 1.84e-01. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 332/1500 [00:04&lt;00:23, 50.44it/s, 31 steps of size 1.30e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 338/1500 [00:04&lt;00:22, 50.64it/s, 29 steps of size 6.21e-02. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 344/1500 [00:04&lt;00:22, 51.21it/s, 31 steps of size 9.47e-02. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 352/1500 [00:04&lt;00:20, 55.83it/s, 31 steps of size 1.03e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñç       | 358/1500 [00:05&lt;00:25, 44.60it/s, 31 steps of size 1.56e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñç       | 363/1500 [00:05&lt;00:25, 44.48it/s, 31 steps of size 1.32e-01. acc. prob=0.78]warmup:  25%|‚ñà‚ñà‚ñç       | 372/1500 [00:05&lt;00:21, 51.37it/s, 63 steps of size 1.03e-01. acc. prob=0.78]warmup:  25%|‚ñà‚ñà‚ñå       | 379/1500 [00:05&lt;00:20, 53.78it/s, 31 steps of size 1.31e-01. acc. prob=0.78]warmup:  26%|‚ñà‚ñà‚ñå       | 385/1500 [00:05&lt;00:20, 55.02it/s, 31 steps of size 9.69e-02. acc. prob=0.78]warmup:  26%|‚ñà‚ñà‚ñå       | 393/1500 [00:05&lt;00:19, 57.91it/s, 63 steps of size 1.04e-01. acc. prob=0.78]warmup:  27%|‚ñà‚ñà‚ñã       | 399/1500 [00:05&lt;00:20, 54.30it/s, 31 steps of size 1.50e-01. acc. prob=0.78]warmup:  27%|‚ñà‚ñà‚ñã       | 405/1500 [00:05&lt;00:20, 53.13it/s, 31 steps of size 1.96e-01. acc. prob=0.78]warmup:  27%|‚ñà‚ñà‚ñã       | 411/1500 [00:06&lt;00:21, 51.80it/s, 11 steps of size 1.53e-01. acc. prob=0.78]warmup:  28%|‚ñà‚ñà‚ñä       | 417/1500 [00:06&lt;00:21, 50.82it/s, 31 steps of size 1.59e-01. acc. prob=0.78]warmup:  28%|‚ñà‚ñà‚ñä       | 423/1500 [00:06&lt;00:21, 51.26it/s, 31 steps of size 1.52e-01. acc. prob=0.78]warmup:  29%|‚ñà‚ñà‚ñä       | 430/1500 [00:06&lt;00:20, 51.72it/s, 63 steps of size 9.50e-02. acc. prob=0.78]warmup:  29%|‚ñà‚ñà‚ñâ       | 436/1500 [00:06&lt;00:22, 47.34it/s, 63 steps of size 1.21e-01. acc. prob=0.78]warmup:  29%|‚ñà‚ñà‚ñâ       | 441/1500 [00:06&lt;00:22, 46.35it/s, 63 steps of size 9.49e-02. acc. prob=0.78]warmup:  30%|‚ñà‚ñà‚ñâ       | 447/1500 [00:06&lt;00:21, 48.26it/s, 31 steps of size 1.20e-01. acc. prob=0.78]warmup:  30%|‚ñà‚ñà‚ñà       | 456/1500 [00:06&lt;00:18, 57.55it/s, 63 steps of size 1.13e-01. acc. prob=0.78]warmup:  31%|‚ñà‚ñà‚ñà       | 462/1500 [00:06&lt;00:18, 56.98it/s, 63 steps of size 1.71e-01. acc. prob=0.78]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 477/1500 [00:07&lt;00:12, 80.45it/s, 23 steps of size 3.79e-01. acc. prob=0.78]warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 489/1500 [00:07&lt;00:11, 90.36it/s, 9 steps of size 1.05e-01. acc. prob=0.78] warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 499/1500 [00:07&lt;00:10, 91.39it/s, 8 steps of size 8.38e-02. acc. prob=0.78]sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 509/1500 [00:07&lt;00:11, 86.76it/s, 15 steps of size 2.64e-01. acc. prob=0.98]sample:  35%|‚ñà‚ñà‚ñà‚ñç      | 521/1500 [00:07&lt;00:10, 93.97it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  35%|‚ñà‚ñà‚ñà‚ñå      | 532/1500 [00:07&lt;00:10, 96.68it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  36%|‚ñà‚ñà‚ñà‚ñã      | 544/1500 [00:07&lt;00:09, 102.19it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 555/1500 [00:07&lt;00:10, 85.94it/s, 31 steps of size 2.64e-01. acc. prob=0.96] sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 565/1500 [00:08&lt;00:11, 83.23it/s, 31 steps of size 2.64e-01. acc. prob=0.96]sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 574/1500 [00:08&lt;00:10, 84.58it/s, 7 steps of size 2.64e-01. acc. prob=0.96] sample:  39%|‚ñà‚ñà‚ñà‚ñâ      | 584/1500 [00:08&lt;00:10, 87.24it/s, 31 steps of size 2.64e-01. acc. prob=0.96]sample:  40%|‚ñà‚ñà‚ñà‚ñâ      | 597/1500 [00:08&lt;00:09, 97.67it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  41%|‚ñà‚ñà‚ñà‚ñà      | 609/1500 [00:08&lt;00:08, 103.80it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 621/1500 [00:08&lt;00:08, 107.13it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 634/1500 [00:08&lt;00:07, 112.37it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 648/1500 [00:08&lt;00:07, 118.67it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 660/1500 [00:08&lt;00:07, 117.46it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 672/1500 [00:09&lt;00:07, 112.25it/s, 31 steps of size 2.64e-01. acc. prob=0.96]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 685/1500 [00:09&lt;00:07, 115.87it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 697/1500 [00:09&lt;00:07, 114.36it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 709/1500 [00:09&lt;00:07, 108.87it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 720/1500 [00:09&lt;00:07, 109.16it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 731/1500 [00:09&lt;00:07, 108.01it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 744/1500 [00:09&lt;00:06, 112.16it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 757/1500 [00:09&lt;00:06, 116.73it/s, 7 steps of size 2.64e-01. acc. prob=0.96] sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 769/1500 [00:09&lt;00:06, 115.76it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 782/1500 [00:09&lt;00:06, 115.13it/s, 31 steps of size 2.64e-01. acc. prob=0.96]sample:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 794/1500 [00:10&lt;00:06, 113.35it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 806/1500 [00:10&lt;00:06, 115.12it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 819/1500 [00:10&lt;00:05, 117.88it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 831/1500 [00:10&lt;00:05, 111.85it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 843/1500 [00:10&lt;00:06, 107.25it/s, 8 steps of size 2.64e-01. acc. prob=0.96] sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 856/1500 [00:10&lt;00:05, 111.36it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 868/1500 [00:10&lt;00:05, 113.56it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 883/1500 [00:10&lt;00:05, 121.27it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 896/1500 [00:10&lt;00:05, 117.91it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 908/1500 [00:11&lt;00:05, 117.13it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 921/1500 [00:11&lt;00:04, 119.58it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 933/1500 [00:11&lt;00:04, 118.29it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 945/1500 [00:11&lt;00:04, 111.48it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 958/1500 [00:11&lt;00:04, 115.48it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 971/1500 [00:11&lt;00:04, 116.80it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 984/1500 [00:11&lt;00:04, 119.28it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 996/1500 [00:11&lt;00:04, 118.44it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1009/1500 [00:11&lt;00:04, 120.62it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1022/1500 [00:12&lt;00:03, 122.18it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1035/1500 [00:12&lt;00:03, 123.42it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1048/1500 [00:12&lt;00:03, 124.08it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1061/1500 [00:12&lt;00:03, 121.38it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1074/1500 [00:12&lt;00:03, 119.43it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1087/1500 [00:12&lt;00:03, 119.65it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1100/1500 [00:12&lt;00:03, 121.30it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1113/1500 [00:12&lt;00:03, 116.65it/s, 7 steps of size 2.64e-01. acc. prob=0.96] sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1127/1500 [00:12&lt;00:03, 120.87it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1140/1500 [00:13&lt;00:03, 116.26it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1152/1500 [00:13&lt;00:03, 113.77it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1165/1500 [00:13&lt;00:02, 117.15it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1177/1500 [00:13&lt;00:02, 116.55it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1189/1500 [00:13&lt;00:02, 114.83it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1203/1500 [00:13&lt;00:02, 119.28it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1215/1500 [00:13&lt;00:02, 115.24it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1227/1500 [00:13&lt;00:02, 115.32it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1240/1500 [00:13&lt;00:02, 117.91it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1252/1500 [00:13&lt;00:02, 116.81it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1264/1500 [00:14&lt;00:02, 113.64it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1278/1500 [00:14&lt;00:01, 118.48it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1291/1500 [00:14&lt;00:01, 120.44it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1304/1500 [00:14&lt;00:01, 120.49it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1317/1500 [00:14&lt;00:01, 118.69it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1330/1500 [00:14&lt;00:01, 120.58it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1343/1500 [00:14&lt;00:01, 120.30it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1356/1500 [00:14&lt;00:01, 117.18it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1369/1500 [00:14&lt;00:01, 118.17it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1382/1500 [00:15&lt;00:00, 118.91it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1394/1500 [00:15&lt;00:00, 117.85it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1406/1500 [00:15&lt;00:00, 112.93it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1418/1500 [00:15&lt;00:00, 111.19it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1430/1500 [00:15&lt;00:00, 112.69it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1442/1500 [00:15&lt;00:00, 105.58it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1454/1500 [00:15&lt;00:00, 107.21it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1466/1500 [00:15&lt;00:00, 109.53it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1479/1500 [00:15&lt;00:00, 114.20it/s, 7 steps of size 2.64e-01. acc. prob=0.96] sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1491/1500 [00:16&lt;00:00, 113.35it/s, 15 steps of size 2.64e-01. acc. prob=0.96]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:16&lt;00:00, 92.91it/s, 15 steps of size 2.64e-01. acc. prob=0.96] 
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   0%|          | 7/1500 [00:00&lt;00:23, 62.60it/s, 31 steps of size 6.82e-02. acc. prob=0.57]warmup:   1%|          | 14/1500 [00:00&lt;00:33, 43.82it/s, 15 steps of size 1.79e-01. acc. prob=0.71]warmup:   1%|‚ñè         | 19/1500 [00:00&lt;00:44, 33.37it/s, 7 steps of size 1.40e-01. acc. prob=0.73] warmup:   2%|‚ñè         | 28/1500 [00:00&lt;00:30, 48.16it/s, 15 steps of size 2.00e-01. acc. prob=0.75]warmup:   2%|‚ñè         | 37/1500 [00:00&lt;00:24, 59.03it/s, 7 steps of size 2.48e-02. acc. prob=0.74] warmup:   3%|‚ñé         | 47/1500 [00:00&lt;00:20, 69.72it/s, 15 steps of size 6.99e-02. acc. prob=0.76]warmup:   4%|‚ñç         | 59/1500 [00:00&lt;00:18, 79.96it/s, 31 steps of size 1.22e-01. acc. prob=0.77]warmup:   5%|‚ñç         | 70/1500 [00:01&lt;00:16, 86.65it/s, 15 steps of size 1.34e-01. acc. prob=0.77]warmup:   6%|‚ñå         | 85/1500 [00:01&lt;00:13, 102.33it/s, 15 steps of size 7.91e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 98/1500 [00:01&lt;00:13, 106.16it/s, 31 steps of size 8.77e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 109/1500 [00:01&lt;00:17, 80.02it/s, 15 steps of size 3.89e-02. acc. prob=0.77]warmup:   8%|‚ñä         | 119/1500 [00:01&lt;00:23, 57.80it/s, 31 steps of size 2.39e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 127/1500 [00:01&lt;00:25, 53.15it/s, 31 steps of size 2.24e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 134/1500 [00:02&lt;00:25, 53.36it/s, 7 steps of size 4.05e-02. acc. prob=0.77] warmup:   9%|‚ñâ         | 141/1500 [00:02&lt;00:28, 48.00it/s, 15 steps of size 2.19e-01. acc. prob=0.78]warmup:  10%|‚ñâ         | 148/1500 [00:02&lt;00:26, 50.69it/s, 31 steps of size 2.18e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 160/1500 [00:02&lt;00:20, 64.86it/s, 7 steps of size 4.85e-01. acc. prob=0.78] warmup:  11%|‚ñà‚ñè        | 172/1500 [00:02&lt;00:17, 77.00it/s, 7 steps of size 4.31e-01. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 184/1500 [00:02&lt;00:15, 87.54it/s, 7 steps of size 8.99e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñé        | 205/1500 [00:02&lt;00:11, 117.47it/s, 15 steps of size 4.86e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 221/1500 [00:02&lt;00:10, 127.73it/s, 7 steps of size 4.76e-01. acc. prob=0.78] warmup:  16%|‚ñà‚ñå        | 235/1500 [00:03&lt;00:09, 127.20it/s, 15 steps of size 6.90e-01. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 256/1500 [00:03&lt;00:08, 147.35it/s, 15 steps of size 3.74e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 272/1500 [00:03&lt;00:12, 96.45it/s, 15 steps of size 2.83e-01. acc. prob=0.78] warmup:  19%|‚ñà‚ñâ        | 285/1500 [00:03&lt;00:12, 99.68it/s, 2 steps of size 1.44e-01. acc. prob=0.78] warmup:  20%|‚ñà‚ñâ        | 297/1500 [00:03&lt;00:12, 96.16it/s, 15 steps of size 1.73e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà        | 308/1500 [00:03&lt;00:12, 97.12it/s, 15 steps of size 1.74e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà‚ñè       | 319/1500 [00:03&lt;00:13, 85.29it/s, 31 steps of size 1.49e-01. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 329/1500 [00:04&lt;00:13, 88.41it/s, 31 steps of size 1.68e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 339/1500 [00:04&lt;00:12, 91.09it/s, 15 steps of size 1.86e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 351/1500 [00:04&lt;00:12, 95.22it/s, 31 steps of size 2.06e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñç       | 365/1500 [00:04&lt;00:10, 106.94it/s, 7 steps of size 3.64e-01. acc. prob=0.78]warmup:  25%|‚ñà‚ñà‚ñå       | 378/1500 [00:04&lt;00:10, 108.15it/s, 31 steps of size 1.73e-01. acc. prob=0.78]warmup:  26%|‚ñà‚ñà‚ñå       | 390/1500 [00:04&lt;00:10, 110.70it/s, 15 steps of size 1.76e-01. acc. prob=0.78]warmup:  27%|‚ñà‚ñà‚ñã       | 405/1500 [00:04&lt;00:09, 119.29it/s, 15 steps of size 2.19e-01. acc. prob=0.78]warmup:  28%|‚ñà‚ñà‚ñä       | 418/1500 [00:04&lt;00:09, 116.35it/s, 15 steps of size 3.77e-01. acc. prob=0.79]warmup:  29%|‚ñà‚ñà‚ñä       | 431/1500 [00:04&lt;00:09, 118.02it/s, 15 steps of size 2.90e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñâ       | 444/1500 [00:05&lt;00:08, 117.90it/s, 31 steps of size 2.47e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà       | 460/1500 [00:05&lt;00:08, 128.08it/s, 31 steps of size 1.97e-01. acc. prob=0.78]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 473/1500 [00:05&lt;00:08, 114.91it/s, 31 steps of size 2.16e-01. acc. prob=0.78]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 485/1500 [00:05&lt;00:09, 104.15it/s, 15 steps of size 6.33e-01. acc. prob=0.79]warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 498/1500 [00:05&lt;00:09, 109.69it/s, 15 steps of size 2.64e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 512/1500 [00:05&lt;00:08, 116.51it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  35%|‚ñà‚ñà‚ñà‚ñå      | 527/1500 [00:05&lt;00:07, 123.04it/s, 15 steps of size 3.09e-01. acc. prob=0.93]sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 541/1500 [00:05&lt;00:07, 124.91it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 554/1500 [00:05&lt;00:07, 126.21it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 567/1500 [00:06&lt;00:07, 121.02it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  39%|‚ñà‚ñà‚ñà‚ñä      | 581/1500 [00:06&lt;00:07, 124.89it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  40%|‚ñà‚ñà‚ñà‚ñâ      | 594/1500 [00:06&lt;00:07, 124.87it/s, 7 steps of size 3.09e-01. acc. prob=0.94]sample:  41%|‚ñà‚ñà‚ñà‚ñà      | 610/1500 [00:06&lt;00:06, 132.38it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 626/1500 [00:06&lt;00:06, 139.18it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 641/1500 [00:06&lt;00:06, 141.13it/s, 7 steps of size 3.09e-01. acc. prob=0.94]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 656/1500 [00:06&lt;00:06, 139.10it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 670/1500 [00:06&lt;00:06, 138.08it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 684/1500 [00:06&lt;00:06, 135.21it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 699/1500 [00:07&lt;00:05, 136.90it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 714/1500 [00:07&lt;00:05, 139.67it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 728/1500 [00:07&lt;00:05, 138.61it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 746/1500 [00:07&lt;00:05, 147.85it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 761/1500 [00:07&lt;00:05, 140.08it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 776/1500 [00:07&lt;00:05, 136.65it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 791/1500 [00:07&lt;00:05, 137.69it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 807/1500 [00:07&lt;00:04, 142.95it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 822/1500 [00:07&lt;00:04, 143.81it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 837/1500 [00:08&lt;00:04, 140.95it/s, 7 steps of size 3.09e-01. acc. prob=0.94]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 852/1500 [00:08&lt;00:04, 139.52it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 868/1500 [00:08&lt;00:04, 143.60it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 885/1500 [00:08&lt;00:04, 148.45it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 900/1500 [00:08&lt;00:04, 144.18it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 915/1500 [00:08&lt;00:04, 139.36it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 929/1500 [00:08&lt;00:04, 136.71it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 947/1500 [00:08&lt;00:03, 145.60it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 962/1500 [00:08&lt;00:03, 138.69it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 976/1500 [00:09&lt;00:03, 136.18it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 991/1500 [00:09&lt;00:03, 138.87it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1005/1500 [00:09&lt;00:03, 135.21it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1020/1500 [00:09&lt;00:03, 136.26it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1037/1500 [00:09&lt;00:03, 143.10it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1052/1500 [00:09&lt;00:03, 143.79it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1068/1500 [00:09&lt;00:02, 144.95it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1083/1500 [00:09&lt;00:03, 134.68it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1098/1500 [00:09&lt;00:02, 136.34it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1112/1500 [00:09&lt;00:02, 136.04it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1126/1500 [00:10&lt;00:02, 136.11it/s, 7 steps of size 3.09e-01. acc. prob=0.94]sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1142/1500 [00:10&lt;00:02, 142.00it/s, 7 steps of size 3.09e-01. acc. prob=0.94]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1157/1500 [00:10&lt;00:02, 143.22it/s, 23 steps of size 3.09e-01. acc. prob=0.94]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1172/1500 [00:10&lt;00:02, 138.87it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1186/1500 [00:10&lt;00:02, 133.08it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1202/1500 [00:10&lt;00:02, 139.50it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1217/1500 [00:10&lt;00:02, 136.39it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1233/1500 [00:10&lt;00:01, 140.40it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1248/1500 [00:10&lt;00:01, 137.04it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1264/1500 [00:11&lt;00:01, 142.67it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1279/1500 [00:11&lt;00:01, 143.29it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1294/1500 [00:11&lt;00:01, 142.17it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1309/1500 [00:11&lt;00:01, 138.19it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1326/1500 [00:11&lt;00:01, 144.34it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1341/1500 [00:11&lt;00:01, 142.93it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1356/1500 [00:11&lt;00:01, 139.16it/s, 7 steps of size 3.09e-01. acc. prob=0.94]sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1372/1500 [00:11&lt;00:00, 143.89it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1387/1500 [00:11&lt;00:00, 143.27it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1405/1500 [00:12&lt;00:00, 151.14it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1421/1500 [00:12&lt;00:00, 141.31it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1436/1500 [00:12&lt;00:00, 135.58it/s, 7 steps of size 3.09e-01. acc. prob=0.94] sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1450/1500 [00:12&lt;00:00, 130.35it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1465/1500 [00:12&lt;00:00, 132.63it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1479/1500 [00:12&lt;00:00, 133.10it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1495/1500 [00:12&lt;00:00, 140.55it/s, 15 steps of size 3.09e-01. acc. prob=0.94]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:12&lt;00:00, 117.43it/s, 15 steps of size 3.09e-01. acc. prob=0.94]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   0%|          | 7/1500 [00:00&lt;00:31, 47.22it/s, 95 steps of size 6.47e-02. acc. prob=0.57]warmup:   1%|          | 13/1500 [00:00&lt;00:32, 45.58it/s, 63 steps of size 4.48e-02. acc. prob=0.67]warmup:   1%|‚ñè         | 22/1500 [00:00&lt;00:24, 60.42it/s, 15 steps of size 7.77e-02. acc. prob=0.72]warmup:   2%|‚ñè         | 29/1500 [00:00&lt;00:25, 57.82it/s, 47 steps of size 6.34e-02. acc. prob=0.74]warmup:   2%|‚ñè         | 37/1500 [00:00&lt;00:23, 62.75it/s, 47 steps of size 8.02e-02. acc. prob=0.75]warmup:   3%|‚ñé         | 52/1500 [00:00&lt;00:18, 78.43it/s, 95 steps of size 9.74e-02. acc. prob=0.76]warmup:   4%|‚ñç         | 60/1500 [00:01&lt;00:30, 46.88it/s, 15 steps of size 1.47e-01. acc. prob=0.77]warmup:   5%|‚ñç         | 71/1500 [00:01&lt;00:26, 53.63it/s, 111 steps of size 8.92e-02. acc. prob=0.77]warmup:   5%|‚ñå         | 80/1500 [00:01&lt;00:26, 54.26it/s, 127 steps of size 1.16e-01. acc. prob=0.77]warmup:   6%|‚ñå         | 87/1500 [00:01&lt;00:29, 47.78it/s, 255 steps of size 5.11e-02. acc. prob=0.77]warmup:   6%|‚ñã         | 96/1500 [00:01&lt;00:26, 52.92it/s, 55 steps of size 1.84e-01. acc. prob=0.78] warmup:   7%|‚ñã         | 104/1500 [00:01&lt;00:24, 58.10it/s, 15 steps of size 4.28e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 113/1500 [00:01&lt;00:21, 64.83it/s, 63 steps of size 1.11e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 121/1500 [00:02&lt;00:21, 64.69it/s, 15 steps of size 3.48e-01. acc. prob=0.78]warmup:   9%|‚ñä         | 128/1500 [00:02&lt;00:21, 64.88it/s, 63 steps of size 1.12e-01. acc. prob=0.77]warmup:   9%|‚ñâ         | 135/1500 [00:02&lt;00:22, 61.32it/s, 31 steps of size 1.66e-01. acc. prob=0.78]warmup:  10%|‚ñâ         | 143/1500 [00:02&lt;00:20, 64.91it/s, 31 steps of size 1.44e-01. acc. prob=0.78]warmup:  10%|‚ñà         | 150/1500 [00:02&lt;00:23, 57.64it/s, 15 steps of size 2.53e-01. acc. prob=0.78]warmup:  10%|‚ñà         | 157/1500 [00:03&lt;00:39, 33.94it/s, 31 steps of size 6.55e-02. acc. prob=0.77]warmup:  11%|‚ñà         | 162/1500 [00:03&lt;00:47, 28.20it/s, 127 steps of size 5.33e-02. acc. prob=0.77]warmup:  11%|‚ñà         | 166/1500 [00:03&lt;00:52, 25.33it/s, 255 steps of size 2.94e-02. acc. prob=0.77]warmup:  11%|‚ñà‚ñè        | 170/1500 [00:03&lt;00:49, 27.01it/s, 63 steps of size 7.03e-02. acc. prob=0.77] warmup:  12%|‚ñà‚ñè        | 174/1500 [00:04&lt;01:31, 14.51it/s, 127 steps of size 4.41e-02. acc. prob=0.77]warmup:  12%|‚ñà‚ñè        | 178/1500 [00:04&lt;01:18, 16.94it/s, 127 steps of size 5.21e-02. acc. prob=0.77]warmup:  12%|‚ñà‚ñè        | 181/1500 [00:04&lt;01:23, 15.75it/s, 319 steps of size 2.49e-02. acc. prob=0.77]warmup:  12%|‚ñà‚ñè        | 184/1500 [00:04&lt;01:18, 16.78it/s, 23 steps of size 2.36e-02. acc. prob=0.77] warmup:  12%|‚ñà‚ñè        | 187/1500 [00:04&lt;01:18, 16.70it/s, 63 steps of size 2.29e-02. acc. prob=0.77]warmup:  13%|‚ñà‚ñé        | 190/1500 [00:05&lt;01:27, 14.97it/s, 63 steps of size 7.28e-03. acc. prob=0.77]warmup:  13%|‚ñà‚ñé        | 192/1500 [00:05&lt;02:08, 10.20it/s, 255 steps of size 2.11e-02. acc. prob=0.77]warmup:  13%|‚ñà‚ñé        | 194/1500 [00:05&lt;02:06, 10.35it/s, 63 steps of size 5.26e-02. acc. prob=0.78] warmup:  13%|‚ñà‚ñé        | 198/1500 [00:05&lt;01:30, 14.41it/s, 63 steps of size 6.38e-02. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 202/1500 [00:06&lt;01:10, 18.50it/s, 35 steps of size 1.49e-02. acc. prob=0.77]warmup:  14%|‚ñà‚ñé        | 205/1500 [00:06&lt;01:21, 15.96it/s, 63 steps of size 6.43e-02. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 208/1500 [00:06&lt;01:11, 18.09it/s, 63 steps of size 6.37e-02. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 211/1500 [00:06&lt;01:08, 18.75it/s, 63 steps of size 6.81e-02. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 214/1500 [00:06&lt;01:26, 14.91it/s, 255 steps of size 3.86e-02. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 218/1500 [00:07&lt;01:12, 17.70it/s, 127 steps of size 3.84e-02. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 221/1500 [00:07&lt;01:07, 18.86it/s, 31 steps of size 7.33e-02. acc. prob=0.78] warmup:  15%|‚ñà‚ñç        | 224/1500 [00:07&lt;01:02, 20.55it/s, 63 steps of size 5.93e-02. acc. prob=0.78]warmup:  15%|‚ñà‚ñå        | 229/1500 [00:07&lt;00:47, 26.61it/s, 15 steps of size 3.69e-02. acc. prob=0.78]warmup:  16%|‚ñà‚ñå        | 233/1500 [00:07&lt;00:47, 26.66it/s, 127 steps of size 2.64e-02. acc. prob=0.78]warmup:  16%|‚ñà‚ñå        | 236/1500 [00:07&lt;00:54, 22.99it/s, 127 steps of size 7.13e-02. acc. prob=0.78]warmup:  16%|‚ñà‚ñå        | 241/1500 [00:07&lt;00:45, 27.94it/s, 31 steps of size 8.01e-02. acc. prob=0.78] warmup:  16%|‚ñà‚ñã        | 245/1500 [00:08&lt;00:49, 25.20it/s, 63 steps of size 6.73e-02. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 248/1500 [00:08&lt;00:51, 24.53it/s, 63 steps of size 7.92e-02. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 251/1500 [00:08&lt;00:50, 24.61it/s, 95 steps of size 6.99e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 265/1500 [00:08&lt;00:24, 51.36it/s, 15 steps of size 1.98e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñä        | 281/1500 [00:08&lt;00:15, 77.39it/s, 15 steps of size 8.05e-01. acc. prob=0.78]warmup:  20%|‚ñà‚ñà        | 302/1500 [00:08&lt;00:10, 109.47it/s, 15 steps of size 7.96e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà‚ñè       | 319/1500 [00:08&lt;00:09, 124.10it/s, 15 steps of size 5.79e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 338/1500 [00:08&lt;00:08, 139.19it/s, 15 steps of size 4.42e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñé       | 356/1500 [00:08&lt;00:07, 150.15it/s, 15 steps of size 6.44e-01. acc. prob=0.79]warmup:  25%|‚ñà‚ñà‚ñå       | 376/1500 [00:09&lt;00:06, 162.34it/s, 7 steps of size 6.63e-01. acc. prob=0.79] warmup:  27%|‚ñà‚ñà‚ñã       | 398/1500 [00:09&lt;00:06, 177.06it/s, 15 steps of size 6.08e-01. acc. prob=0.79]warmup:  28%|‚ñà‚ñà‚ñä       | 419/1500 [00:09&lt;00:05, 184.49it/s, 7 steps of size 5.56e-01. acc. prob=0.79] warmup:  29%|‚ñà‚ñà‚ñâ       | 439/1500 [00:09&lt;00:05, 188.45it/s, 7 steps of size 5.27e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà       | 460/1500 [00:09&lt;00:05, 185.21it/s, 31 steps of size 1.32e-01. acc. prob=0.79]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 479/1500 [00:09&lt;00:06, 158.48it/s, 7 steps of size 1.63e-01. acc. prob=0.79] warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 496/1500 [00:09&lt;00:06, 157.43it/s, 31 steps of size 2.50e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 516/1500 [00:09&lt;00:05, 166.89it/s, 7 steps of size 3.79e-01. acc. prob=0.89] sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 536/1500 [00:09&lt;00:05, 174.49it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 554/1500 [00:10&lt;00:05, 170.88it/s, 15 steps of size 3.79e-01. acc. prob=0.92]sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 572/1500 [00:10&lt;00:05, 169.40it/s, 7 steps of size 3.79e-01. acc. prob=0.92] sample:  39%|‚ñà‚ñà‚ñà‚ñâ      | 591/1500 [00:10&lt;00:05, 172.92it/s, 15 steps of size 3.79e-01. acc. prob=0.92]sample:  41%|‚ñà‚ñà‚ñà‚ñà      | 613/1500 [00:10&lt;00:04, 183.56it/s, 15 steps of size 3.79e-01. acc. prob=0.92]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 632/1500 [00:10&lt;00:04, 179.82it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 651/1500 [00:10&lt;00:04, 175.34it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 669/1500 [00:10&lt;00:04, 166.39it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 687/1500 [00:10&lt;00:04, 170.02it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 705/1500 [00:10&lt;00:04, 169.31it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 725/1500 [00:11&lt;00:04, 174.11it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 743/1500 [00:11&lt;00:04, 165.13it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 762/1500 [00:11&lt;00:04, 169.46it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 780/1500 [00:11&lt;00:04, 169.21it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 799/1500 [00:11&lt;00:04, 174.57it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 817/1500 [00:11&lt;00:03, 174.16it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 836/1500 [00:11&lt;00:03, 175.93it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 856/1500 [00:11&lt;00:03, 181.69it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 875/1500 [00:11&lt;00:03, 174.00it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 896/1500 [00:12&lt;00:03, 180.66it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 915/1500 [00:12&lt;00:03, 171.70it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 933/1500 [00:12&lt;00:03, 173.28it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 952/1500 [00:12&lt;00:03, 177.73it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 970/1500 [00:12&lt;00:03, 176.27it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 988/1500 [00:12&lt;00:03, 169.52it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1008/1500 [00:12&lt;00:02, 177.75it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1029/1500 [00:12&lt;00:02, 184.83it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1048/1500 [00:12&lt;00:02, 184.51it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1067/1500 [00:12&lt;00:02, 182.82it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1086/1500 [00:13&lt;00:02, 176.81it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1104/1500 [00:13&lt;00:02, 171.14it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1122/1500 [00:13&lt;00:02, 167.94it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1139/1500 [00:13&lt;00:02, 167.65it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1159/1500 [00:13&lt;00:01, 173.26it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1177/1500 [00:13&lt;00:01, 168.10it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1195/1500 [00:13&lt;00:01, 170.90it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1213/1500 [00:13&lt;00:01, 166.86it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1230/1500 [00:13&lt;00:01, 163.33it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1247/1500 [00:14&lt;00:01, 161.32it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1264/1500 [00:14&lt;00:01, 156.90it/s, 23 steps of size 3.79e-01. acc. prob=0.91]sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1280/1500 [00:14&lt;00:01, 153.88it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1297/1500 [00:14&lt;00:01, 157.98it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1313/1500 [00:14&lt;00:01, 157.21it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1329/1500 [00:14&lt;00:01, 153.84it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1346/1500 [00:14&lt;00:00, 157.56it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1362/1500 [00:14&lt;00:00, 152.72it/s, 7 steps of size 3.79e-01. acc. prob=0.91]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1382/1500 [00:14&lt;00:00, 165.87it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1399/1500 [00:15&lt;00:00, 154.84it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1415/1500 [00:15&lt;00:00, 145.80it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1437/1500 [00:15&lt;00:00, 162.50it/s, 15 steps of size 3.79e-01. acc. prob=0.91]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1454/1500 [00:15&lt;00:00, 161.25it/s, 7 steps of size 3.79e-01. acc. prob=0.91] sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1471/1500 [00:15&lt;00:00, 155.86it/s, 7 steps of size 3.79e-01. acc. prob=0.92]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1488/1500 [00:15&lt;00:00, 157.08it/s, 15 steps of size 3.79e-01. acc. prob=0.92]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:15&lt;00:00, 95.48it/s, 15 steps of size 3.79e-01. acc. prob=0.92] 
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   1%|          | 10/1500 [00:00&lt;00:14, 99.53it/s, 31 steps of size 1.09e-01. acc. prob=0.66]warmup:   1%|‚ñè         | 20/1500 [00:00&lt;00:19, 77.29it/s, 7 steps of size 1.60e-02. acc. prob=0.69] warmup:   2%|‚ñè         | 29/1500 [00:00&lt;00:18, 78.33it/s, 7 steps of size 1.02e-01. acc. prob=0.74]warmup:   3%|‚ñé         | 41/1500 [00:00&lt;00:15, 92.28it/s, 7 steps of size 3.18e-02. acc. prob=0.74]warmup:   3%|‚ñé         | 51/1500 [00:00&lt;00:16, 89.37it/s, 31 steps of size 1.29e-01. acc. prob=0.76]warmup:   4%|‚ñç         | 63/1500 [00:00&lt;00:14, 96.42it/s, 15 steps of size 1.63e-01. acc. prob=0.77]warmup:   5%|‚ñç         | 73/1500 [00:00&lt;00:14, 97.00it/s, 15 steps of size 7.66e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 83/1500 [00:00&lt;00:15, 90.70it/s, 23 steps of size 9.68e-02. acc. prob=0.77]warmup:   6%|‚ñã         | 96/1500 [00:01&lt;00:13, 100.45it/s, 31 steps of size 7.97e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 107/1500 [00:01&lt;00:18, 76.44it/s, 63 steps of size 1.84e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 117/1500 [00:01&lt;00:16, 81.60it/s, 7 steps of size 6.26e-01. acc. prob=0.78] warmup:   9%|‚ñä         | 129/1500 [00:01&lt;00:15, 90.35it/s, 15 steps of size 6.45e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 139/1500 [00:01&lt;00:15, 89.94it/s, 15 steps of size 6.32e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 158/1500 [00:01&lt;00:12, 106.29it/s, 63 steps of size 1.02e-01. acc. prob=0.77]warmup:  11%|‚ñà‚ñè        | 171/1500 [00:01&lt;00:11, 111.62it/s, 7 steps of size 1.55e-01. acc. prob=0.78] warmup:  12%|‚ñà‚ñè        | 187/1500 [00:01&lt;00:10, 124.53it/s, 3 steps of size 3.11e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 200/1500 [00:02&lt;00:10, 122.00it/s, 15 steps of size 2.48e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 213/1500 [00:02&lt;00:10, 122.73it/s, 7 steps of size 1.10e-01. acc. prob=0.78] warmup:  15%|‚ñà‚ñå        | 226/1500 [00:02&lt;00:10, 116.77it/s, 7 steps of size 3.86e-01. acc. prob=0.78]warmup:  16%|‚ñà‚ñã        | 247/1500 [00:02&lt;00:08, 141.27it/s, 7 steps of size 7.61e-01. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 262/1500 [00:02&lt;00:08, 141.72it/s, 7 steps of size 5.45e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 277/1500 [00:02&lt;00:09, 134.83it/s, 7 steps of size 1.68e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 291/1500 [00:02&lt;00:09, 132.85it/s, 7 steps of size 5.37e-01. acc. prob=0.78]warmup:  20%|‚ñà‚ñà        | 307/1500 [00:02&lt;00:08, 139.98it/s, 7 steps of size 4.89e-01. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 324/1500 [00:02&lt;00:08, 146.01it/s, 15 steps of size 3.66e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 339/1500 [00:02&lt;00:07, 147.00it/s, 31 steps of size 2.54e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñç       | 363/1500 [00:03&lt;00:06, 170.67it/s, 15 steps of size 4.60e-01. acc. prob=0.78]warmup:  25%|‚ñà‚ñà‚ñå       | 382/1500 [00:03&lt;00:06, 176.04it/s, 15 steps of size 3.94e-01. acc. prob=0.79]warmup:  27%|‚ñà‚ñà‚ñã       | 402/1500 [00:03&lt;00:06, 182.98it/s, 7 steps of size 4.60e-01. acc. prob=0.79] warmup:  28%|‚ñà‚ñà‚ñä       | 424/1500 [00:03&lt;00:05, 190.78it/s, 15 steps of size 6.55e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñâ       | 447/1500 [00:03&lt;00:05, 199.35it/s, 15 steps of size 3.05e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà       | 467/1500 [00:03&lt;00:05, 187.98it/s, 7 steps of size 3.26e-01. acc. prob=0.79] warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 486/1500 [00:03&lt;00:05, 174.12it/s, 7 steps of size 5.21e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñé      | 504/1500 [00:03&lt;00:05, 167.50it/s, 7 steps of size 3.81e-01. acc. prob=0.97]sample:  35%|‚ñà‚ñà‚ñà‚ñç      | 524/1500 [00:03&lt;00:05, 173.19it/s, 15 steps of size 3.81e-01. acc. prob=0.94]sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 542/1500 [00:04&lt;00:05, 173.97it/s, 7 steps of size 3.81e-01. acc. prob=0.93] sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 560/1500 [00:04&lt;00:05, 171.28it/s, 7 steps of size 3.81e-01. acc. prob=0.93]sample:  39%|‚ñà‚ñà‚ñà‚ñâ      | 583/1500 [00:04&lt;00:04, 186.34it/s, 7 steps of size 3.81e-01. acc. prob=0.92]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 602/1500 [00:04&lt;00:04, 182.31it/s, 7 steps of size 3.81e-01. acc. prob=0.92]sample:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 621/1500 [00:04&lt;00:04, 176.89it/s, 7 steps of size 3.81e-01. acc. prob=0.92]sample:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 640/1500 [00:04&lt;00:04, 177.84it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 660/1500 [00:04&lt;00:04, 182.31it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 680/1500 [00:04&lt;00:04, 186.61it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 699/1500 [00:04&lt;00:04, 179.31it/s, 7 steps of size 3.81e-01. acc. prob=0.92] sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 718/1500 [00:05&lt;00:04, 176.89it/s, 7 steps of size 3.81e-01. acc. prob=0.92]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 736/1500 [00:05&lt;00:04, 177.42it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 754/1500 [00:05&lt;00:04, 172.73it/s, 7 steps of size 3.81e-01. acc. prob=0.92] sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 772/1500 [00:05&lt;00:04, 171.50it/s, 7 steps of size 3.81e-01. acc. prob=0.91]sample:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 791/1500 [00:05&lt;00:04, 175.48it/s, 7 steps of size 3.81e-01. acc. prob=0.91]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 809/1500 [00:05&lt;00:04, 170.14it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 827/1500 [00:05&lt;00:04, 165.94it/s, 7 steps of size 3.81e-01. acc. prob=0.91] sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 844/1500 [00:05&lt;00:04, 147.70it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 861/1500 [00:05&lt;00:04, 152.38it/s, 7 steps of size 3.81e-01. acc. prob=0.91] sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 877/1500 [00:06&lt;00:04, 149.70it/s, 7 steps of size 3.81e-01. acc. prob=0.91]sample:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 896/1500 [00:06&lt;00:03, 160.19it/s, 3 steps of size 3.81e-01. acc. prob=0.91]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 915/1500 [00:06&lt;00:03, 167.81it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 933/1500 [00:06&lt;00:03, 170.08it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 951/1500 [00:06&lt;00:03, 170.20it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 969/1500 [00:06&lt;00:03, 170.68it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 987/1500 [00:06&lt;00:03, 168.96it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1008/1500 [00:06&lt;00:02, 178.60it/s, 7 steps of size 3.81e-01. acc. prob=0.91]sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1026/1500 [00:06&lt;00:02, 177.54it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1046/1500 [00:07&lt;00:02, 181.38it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1065/1500 [00:07&lt;00:02, 164.10it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1082/1500 [00:07&lt;00:02, 163.82it/s, 7 steps of size 3.81e-01. acc. prob=0.92] sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1099/1500 [00:07&lt;00:02, 152.30it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1115/1500 [00:07&lt;00:02, 147.23it/s, 7 steps of size 3.81e-01. acc. prob=0.92] sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1133/1500 [00:07&lt;00:02, 155.74it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1150/1500 [00:07&lt;00:02, 158.43it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1167/1500 [00:07&lt;00:02, 160.48it/s, 7 steps of size 3.81e-01. acc. prob=0.92] sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1184/1500 [00:07&lt;00:01, 162.74it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1205/1500 [00:08&lt;00:01, 174.72it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1223/1500 [00:08&lt;00:01, 167.58it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1241/1500 [00:08&lt;00:01, 167.62it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1258/1500 [00:08&lt;00:01, 166.71it/s, 7 steps of size 3.81e-01. acc. prob=0.91] sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1276/1500 [00:08&lt;00:01, 169.23it/s, 7 steps of size 3.81e-01. acc. prob=0.91]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1293/1500 [00:08&lt;00:01, 147.21it/s, 7 steps of size 3.81e-01. acc. prob=0.91]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1309/1500 [00:08&lt;00:01, 146.50it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1325/1500 [00:08&lt;00:01, 146.35it/s, 7 steps of size 3.81e-01. acc. prob=0.91] sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1342/1500 [00:08&lt;00:01, 152.64it/s, 7 steps of size 3.81e-01. acc. prob=0.92]sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1358/1500 [00:09&lt;00:00, 147.93it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1377/1500 [00:09&lt;00:00, 158.81it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1394/1500 [00:09&lt;00:00, 161.82it/s, 15 steps of size 3.81e-01. acc. prob=0.91]sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1411/1500 [00:09&lt;00:00, 159.67it/s, 7 steps of size 3.81e-01. acc. prob=0.92] sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1431/1500 [00:09&lt;00:00, 168.45it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1450/1500 [00:09&lt;00:00, 173.96it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1468/1500 [00:09&lt;00:00, 167.71it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1485/1500 [00:09&lt;00:00, 157.01it/s, 15 steps of size 3.81e-01. acc. prob=0.92]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:09&lt;00:00, 151.82it/s, 15 steps of size 3.81e-01. acc. prob=0.92]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                mean       std    median      5.0%     95.0%     n_eff     r_hat
  gamma[0]      0.14      0.02      0.13      0.10      0.17   2074.24      1.00
  gamma[1]      0.08      0.02      0.08      0.04      0.11   2096.10      1.00
  gamma[2]      0.06      0.02      0.06      0.03      0.10   1327.02      1.00
  gamma[3]      0.06      0.02      0.06      0.03      0.09   1504.76      1.00
  gamma[4]      0.06      0.02      0.06      0.03      0.09   1246.58      1.01
  gamma[5]      0.06      0.02      0.06      0.03      0.09   1548.78      1.01
  gamma[6]      0.04      0.02      0.04      0.01      0.08   1332.07      1.00
         p      0.49      0.04      0.49      0.43      0.56   1954.63      1.00
       phi      0.69      0.03      0.69      0.64      0.73   2292.06      1.00

Number of divergences: 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
</div>
<div id="cell-fig-n-prior3" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the posterior predictive distribution for N</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> mcmc.get_samples()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> sample_z(js_prior3, samples, capture_histories)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ever_alive <span class="op">=</span> z.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>) <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>samples[<span class="st">'N'</span>] <span class="op">=</span> ever_alive.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create the plot</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ax.hist(samples[<span class="st">'N'</span>], bins<span class="op">=</span><span class="dv">20</span>, fc<span class="op">=</span><span class="st">'tab:cyan'</span>, ec<span class="op">=</span><span class="st">'w'</span>, alpha<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r'Posterior distribution of </span><span class="dv">$</span><span class="vs">N</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>ax.axvline(SUPERPOPULATION_SIZE, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'tab:pink'</span>, label<span class="op">=</span><span class="st">'Truth'</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>ax.axvline(np.median(samples[<span class="st">'N'</span>]), linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'tab:purple'</span>, label<span class="op">=</span><span class="st">'Median'</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="fig-n-prior3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-n-prior3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="numpyro-js_files/figure-html/fig-n-prior3-output-1.png" width="477" height="381" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-n-prior3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Posterior distribution of <span class="math inline">\(N\)</span> with approximate prior on <span class="math inline">\(\gamma\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Once again these priors do a better job of estimating <span class="math inline">\(N\)</span> than the Uniform prior.</p>
</section>
</section>
<section id="dipper-dataset" class="level1">
<h1>Dipper dataset</h1>
<p>Finally, I turn to the ubiquitous dipper data, analyzed in <span class="citation" data-cites="royle2008">(<a href="#ref-royle2008" role="doc-biblioref">Royle and Dorazio 2008, chap. 10</a>)</span>. To match their analysis, I fit the full version of the model, where every parameter is time varying, i.e., <span class="math inline">\(p(t) \phi(t) \pi(t).\)</span> This model is overparameterized, meaning that not all the parameters are estimable. Following <span class="citation" data-cites="royle2008">(<a href="#ref-royle2008" role="doc-biblioref">Royle and Dorazio 2008</a>)</span>, I skirt this issue by assuming that <span class="math inline">\(p_{0}=p_{T}=1\)</span>.Here, I use the Schwarz-Arnason-esque parameterization.</p>
<p>The primary difference from the above models is the need to index both <code>phi</code> and <code>p</code>. Recall that <code>gamma[0]</code> controls entry into the superpopulation from the initial state to the first iteration of the scan. As such, <code>gamma[1]</code> controls entry into the population at the second occasion, and <code>phi[0]</code> controls survival from the first occasion to the second occasion. As such, the transition probability matrix contains <code>gamma[t]</code> and <code>phi[t - 1]</code>.</p>
<div id="4d9a3a38" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> js_full(capture_history):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    super_size, occasion_count <span class="op">=</span> capture_history.shape</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    interval_count <span class="op">=</span> occasion_count <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    p_count <span class="op">=</span> interval_count <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># parameterize the  entry probabilities in terms of pi and psi</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    psi <span class="op">=</span> numpyro.sample(<span class="st">'psi'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    pi <span class="op">=</span> numpyro.sample(<span class="st">'pi'</span>, dist.Dirichlet(jnp.ones(occasion_count)))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute the removal probabilities as a function of psi and pi</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> jnp.zeros(occasion_count)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the `vector.at[0].set(1)` notation is jax for `vector[0] = 1`</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> gamma.at[<span class="dv">0</span>].<span class="bu">set</span>(psi <span class="op">*</span> pi[<span class="dv">0</span>])</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, occasion_count):</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        denominator <span class="op">=</span> jnp.prod(<span class="dv">1</span> <span class="op">-</span> gamma[:t])</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        gamma <span class="op">=</span> gamma.at[t].<span class="bu">set</span>(psi <span class="op">*</span> pi[t] <span class="op">/</span> denominator)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> numpyro.deterministic(<span class="st">'gamma'</span>, gamma)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> numpyro.plate(<span class="st">'intervals'</span>, interval_count):</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        phi <span class="op">=</span> numpyro.sample(<span class="st">'phi'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> numpyro.plate(<span class="st">'ps'</span>, p_count):</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        p_estimable <span class="op">=</span> numpyro.sample(<span class="st">'p_estimable'</span>, dist.Uniform(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fix the detection probability on the first couple of occasions to 1</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> jnp.concatenate([jnp.array([<span class="dv">1</span>]), p_estimable, jnp.array([<span class="dv">1</span>])])</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> transition_and_capture(carry, y_current):</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>        z_previous, t <span class="op">=</span> carry</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>        trans_probs <span class="op">=</span> jnp.array([</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">1</span> <span class="op">-</span> gamma[t],   gamma[t],            <span class="fl">0.0</span>], <span class="co"># From not yet entered</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>            [         <span class="fl">0.0</span>, phi[t <span class="op">-</span> <span class="dv">1</span>], <span class="dv">1</span> <span class="op">-</span> phi[t <span class="op">-</span> <span class="dv">1</span>]], <span class="co"># From alive</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>            [         <span class="fl">0.0</span>,        <span class="fl">0.0</span>,            <span class="fl">1.0</span>]  <span class="co"># From dead</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> numpyro.plate(<span class="st">"animals"</span>, super_size, dim<span class="op">=-</span><span class="dv">1</span>):</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>            mu_z_current <span class="op">=</span> trans_probs[z_previous]</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>            z_current <span class="op">=</span> numpyro.sample(</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">"state"</span>,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>                dist.Categorical(dist.util.clamp_probs(mu_z_current)),</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>                infer<span class="op">=</span>{<span class="st">"enumerate"</span>: <span class="st">"parallel"</span>}</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>            mu_y_current <span class="op">=</span> jnp.where(z_current <span class="op">==</span> <span class="dv">1</span>, p[t], <span class="fl">0.0</span>)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>            numpyro.sample(</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">"obs"</span>,</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>                dist.Bernoulli(dist.util.clamp_probs(mu_y_current)),</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>                obs<span class="op">=</span>y_current</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (z_current, t <span class="op">+</span> <span class="dv">1</span>), <span class="va">None</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>    state_init <span class="op">=</span> jnp.zeros(super_size, dtype<span class="op">=</span>jnp.int32)</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>    scan(transition_and_capture, (state_init, <span class="dv">0</span>),</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>         jnp.swapaxes(capture_history, <span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="4f10bc00" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dipper <span class="op">=</span> load_dipper_data()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># specify which sampler you want to use</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>nuts_kernel <span class="op">=</span> NUTS(js_full)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># configure the MCMC run</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>mcmc <span class="op">=</span> MCMC(nuts_kernel, num_warmup<span class="op">=</span>WARMUP_COUNT, num_samples<span class="op">=</span>SAMPLE_COUNT,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>            num_chains<span class="op">=</span>CHAIN_COUNT)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># run the MCMC then inspect the output</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>mcmc.run(rng_key, dipper)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>mcmc.print_summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/y8/cz021w550rbb072f7qhxyylh0000gq/T/ipykernel_16237/3437823838.py:7: UserWarning: There are not enough devices to run parallel chains: expected 4 but got 1. Chains will be drawn sequentially. If you are running MCMC in CPU, consider using `numpyro.set_host_device_count(4)` at the beginning of your program. You can double-check how many devices are available in your system using `jax.local_device_count()`.
  mcmc = MCMC(nuts_kernel, num_warmup=WARMUP_COUNT, num_samples=SAMPLE_COUNT,
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   0%|          | 1/1500 [00:00&lt;22:32,  1.11it/s, 1 steps of size 2.34e+00. acc. prob=0.00]warmup:   1%|‚ñè         | 19/1500 [00:01&lt;00:58, 25.18it/s, 63 steps of size 3.60e-02. acc. prob=0.70]warmup:   2%|‚ñè         | 29/1500 [00:01&lt;00:40, 36.74it/s, 15 steps of size 3.09e-02. acc. prob=0.73]warmup:   3%|‚ñé         | 39/1500 [00:01&lt;00:32, 45.44it/s, 15 steps of size 4.67e-02. acc. prob=0.75]warmup:   4%|‚ñé         | 56/1500 [00:01&lt;00:20, 70.15it/s, 31 steps of size 1.16e-01. acc. prob=0.76]warmup:   5%|‚ñç         | 70/1500 [00:01&lt;00:16, 84.25it/s, 63 steps of size 9.20e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 85/1500 [00:01&lt;00:14, 99.10it/s, 15 steps of size 7.65e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 105/1500 [00:01&lt;00:11, 124.14it/s, 7 steps of size 2.03e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 122/1500 [00:01&lt;00:10, 134.71it/s, 15 steps of size 1.95e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 139/1500 [00:01&lt;00:09, 141.79it/s, 63 steps of size 1.43e-01. acc. prob=0.78]warmup:  10%|‚ñà         | 157/1500 [00:01&lt;00:08, 150.79it/s, 15 steps of size 5.05e-01. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 182/1500 [00:02&lt;00:07, 175.27it/s, 31 steps of size 2.66e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 201/1500 [00:02&lt;00:07, 173.97it/s, 15 steps of size 2.84e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 224/1500 [00:02&lt;00:06, 189.06it/s, 15 steps of size 3.19e-01. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 254/1500 [00:02&lt;00:05, 218.27it/s, 15 steps of size 3.50e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 277/1500 [00:02&lt;00:05, 208.09it/s, 7 steps of size 1.48e-01. acc. prob=0.78] warmup:  20%|‚ñà‚ñâ        | 299/1500 [00:02&lt;00:05, 206.43it/s, 15 steps of size 6.24e-01. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 327/1500 [00:02&lt;00:05, 225.66it/s, 31 steps of size 2.62e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñç       | 360/1500 [00:02&lt;00:04, 253.66it/s, 15 steps of size 2.92e-01. acc. prob=0.78]warmup:  26%|‚ñà‚ñà‚ñå       | 386/1500 [00:02&lt;00:04, 255.31it/s, 7 steps of size 5.48e-01. acc. prob=0.79] warmup:  28%|‚ñà‚ñà‚ñä       | 423/1500 [00:03&lt;00:03, 287.22it/s, 7 steps of size 5.62e-01. acc. prob=0.79]warmup:  31%|‚ñà‚ñà‚ñà       | 459/1500 [00:03&lt;00:03, 294.05it/s, 63 steps of size 1.80e-01. acc. prob=0.79]warmup:  33%|‚ñà‚ñà‚ñà‚ñé      | 489/1500 [00:03&lt;00:03, 261.64it/s, 15 steps of size 4.25e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 516/1500 [00:03&lt;00:03, 258.28it/s, 15 steps of size 3.56e-01. acc. prob=0.88]sample:  36%|‚ñà‚ñà‚ñà‚ñã      | 547/1500 [00:03&lt;00:03, 272.19it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 577/1500 [00:03&lt;00:03, 278.36it/s, 15 steps of size 3.56e-01. acc. prob=0.89]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 606/1500 [00:03&lt;00:03, 280.28it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 635/1500 [00:03&lt;00:03, 274.91it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 663/1500 [00:03&lt;00:03, 273.31it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 693/1500 [00:04&lt;00:02, 277.58it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 722/1500 [00:04&lt;00:02, 277.77it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 751/1500 [00:04&lt;00:02, 278.16it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 779/1500 [00:04&lt;00:02, 268.01it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 806/1500 [00:04&lt;00:02, 260.41it/s, 7 steps of size 3.56e-01. acc. prob=0.90] sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 835/1500 [00:04&lt;00:02, 267.50it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 862/1500 [00:04&lt;00:02, 265.19it/s, 47 steps of size 3.56e-01. acc. prob=0.89]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 892/1500 [00:04&lt;00:02, 273.83it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 923/1500 [00:04&lt;00:02, 282.90it/s, 7 steps of size 3.56e-01. acc. prob=0.90] sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 952/1500 [00:04&lt;00:01, 276.39it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 980/1500 [00:05&lt;00:01, 268.96it/s, 7 steps of size 3.56e-01. acc. prob=0.90] sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1007/1500 [00:05&lt;00:01, 266.28it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1035/1500 [00:05&lt;00:01, 268.98it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1062/1500 [00:05&lt;00:01, 264.62it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1089/1500 [00:05&lt;00:01, 261.18it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1116/1500 [00:05&lt;00:01, 262.01it/s, 7 steps of size 3.56e-01. acc. prob=0.90] sample:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1143/1500 [00:05&lt;00:01, 262.03it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1174/1500 [00:05&lt;00:01, 276.01it/s, 7 steps of size 3.56e-01. acc. prob=0.90] sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1202/1500 [00:05&lt;00:01, 275.24it/s, 7 steps of size 3.56e-01. acc. prob=0.90]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1230/1500 [00:06&lt;00:00, 271.37it/s, 7 steps of size 3.56e-01. acc. prob=0.90]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1260/1500 [00:06&lt;00:00, 278.33it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1288/1500 [00:06&lt;00:00, 273.76it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1319/1500 [00:06&lt;00:00, 281.06it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1349/1500 [00:06&lt;00:00, 285.21it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1378/1500 [00:06&lt;00:00, 276.32it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1406/1500 [00:06&lt;00:00, 274.18it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1436/1500 [00:06&lt;00:00, 280.15it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1467/1500 [00:06&lt;00:00, 285.48it/s, 15 steps of size 3.56e-01. acc. prob=0.90]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1496/1500 [00:06&lt;00:00, 275.22it/s, 7 steps of size 3.56e-01. acc. prob=0.90] sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:06&lt;00:00, 214.33it/s, 15 steps of size 3.56e-01. acc. prob=0.90]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   1%|          | 10/1500 [00:00&lt;00:16, 89.57it/s, 63 steps of size 9.04e-02. acc. prob=0.65]warmup:   2%|‚ñè         | 24/1500 [00:00&lt;00:13, 112.32it/s, 63 steps of size 1.67e-01. acc. prob=0.74]warmup:   2%|‚ñè         | 36/1500 [00:00&lt;00:12, 115.38it/s, 31 steps of size 1.76e-01. acc. prob=0.76]warmup:   3%|‚ñé         | 51/1500 [00:00&lt;00:11, 127.98it/s, 31 steps of size 1.34e-01. acc. prob=0.76]warmup:   5%|‚ñç         | 69/1500 [00:00&lt;00:09, 144.65it/s, 15 steps of size 9.43e-02. acc. prob=0.77]warmup:   6%|‚ñå         | 89/1500 [00:00&lt;00:08, 159.66it/s, 47 steps of size 6.68e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 109/1500 [00:00&lt;00:08, 169.61it/s, 31 steps of size 2.52e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 126/1500 [00:00&lt;00:09, 151.11it/s, 15 steps of size 5.00e-01. acc. prob=0.78]warmup:  10%|‚ñâ         | 144/1500 [00:00&lt;00:08, 157.34it/s, 63 steps of size 2.05e-01. acc. prob=0.78]warmup:  11%|‚ñà         | 160/1500 [00:01&lt;00:09, 144.52it/s, 63 steps of size 2.66e-01. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 175/1500 [00:01&lt;00:09, 139.07it/s, 63 steps of size 1.26e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 195/1500 [00:01&lt;00:08, 155.08it/s, 31 steps of size 1.86e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 218/1500 [00:01&lt;00:07, 172.34it/s, 63 steps of size 1.76e-01. acc. prob=0.78]warmup:  16%|‚ñà‚ñå        | 237/1500 [00:01&lt;00:07, 176.79it/s, 7 steps of size 5.14e-01. acc. prob=0.78] warmup:  17%|‚ñà‚ñã        | 259/1500 [00:01&lt;00:06, 185.90it/s, 31 steps of size 2.78e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 283/1500 [00:01&lt;00:06, 197.56it/s, 31 steps of size 2.13e-01. acc. prob=0.78]warmup:  20%|‚ñà‚ñà        | 303/1500 [00:01&lt;00:06, 196.43it/s, 15 steps of size 3.88e-01. acc. prob=0.78]warmup:  22%|‚ñà‚ñà‚ñè       | 328/1500 [00:01&lt;00:05, 208.20it/s, 23 steps of size 6.22e-01. acc. prob=0.78]warmup:  24%|‚ñà‚ñà‚ñé       | 355/1500 [00:02&lt;00:05, 225.84it/s, 15 steps of size 4.16e-01. acc. prob=0.78]warmup:  26%|‚ñà‚ñà‚ñå       | 390/1500 [00:02&lt;00:04, 260.50it/s, 7 steps of size 4.45e-01. acc. prob=0.79] warmup:  28%|‚ñà‚ñà‚ñä       | 417/1500 [00:02&lt;00:04, 259.81it/s, 15 steps of size 3.88e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñâ       | 448/1500 [00:02&lt;00:03, 273.16it/s, 15 steps of size 4.22e-01. acc. prob=0.79]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 476/1500 [00:02&lt;00:03, 257.76it/s, 15 steps of size 5.79e-01. acc. prob=0.79]sample:  34%|‚ñà‚ñà‚ñà‚ñé      | 505/1500 [00:02&lt;00:03, 263.67it/s, 15 steps of size 3.92e-01. acc. prob=0.90]sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 535/1500 [00:02&lt;00:03, 274.01it/s, 7 steps of size 3.92e-01. acc. prob=0.90] sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 571/1500 [00:02&lt;00:03, 297.35it/s, 15 steps of size 3.92e-01. acc. prob=0.89]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 604/1500 [00:02&lt;00:02, 305.07it/s, 15 steps of size 3.92e-01. acc. prob=0.89]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 637/1500 [00:03&lt;00:02, 310.71it/s, 7 steps of size 3.92e-01. acc. prob=0.88] sample:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 669/1500 [00:03&lt;00:02, 307.43it/s, 7 steps of size 3.92e-01. acc. prob=0.89]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 702/1500 [00:03&lt;00:02, 313.83it/s, 7 steps of size 3.92e-01. acc. prob=0.89]sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 738/1500 [00:03&lt;00:02, 326.17it/s, 7 steps of size 3.92e-01. acc. prob=0.89]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 771/1500 [00:03&lt;00:02, 323.87it/s, 7 steps of size 3.92e-01. acc. prob=0.89]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 804/1500 [00:03&lt;00:02, 322.01it/s, 7 steps of size 3.92e-01. acc. prob=0.89]sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 837/1500 [00:03&lt;00:02, 318.52it/s, 15 steps of size 3.92e-01. acc. prob=0.89]sample:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 876/1500 [00:03&lt;00:01, 338.22it/s, 7 steps of size 3.92e-01. acc. prob=0.89] sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 910/1500 [00:03&lt;00:01, 335.36it/s, 15 steps of size 3.92e-01. acc. prob=0.89]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 944/1500 [00:03&lt;00:01, 328.55it/s, 15 steps of size 3.92e-01. acc. prob=0.88]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 981/1500 [00:04&lt;00:01, 339.21it/s, 7 steps of size 3.92e-01. acc. prob=0.88] sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1018/1500 [00:04&lt;00:01, 346.47it/s, 7 steps of size 3.92e-01. acc. prob=0.88]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1053/1500 [00:04&lt;00:01, 334.67it/s, 7 steps of size 3.92e-01. acc. prob=0.88]sample:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1087/1500 [00:04&lt;00:01, 332.49it/s, 7 steps of size 3.92e-01. acc. prob=0.88]sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1121/1500 [00:04&lt;00:01, 322.23it/s, 15 steps of size 3.92e-01. acc. prob=0.88]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1155/1500 [00:04&lt;00:01, 323.30it/s, 15 steps of size 3.92e-01. acc. prob=0.88]sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1188/1500 [00:04&lt;00:00, 317.49it/s, 15 steps of size 3.92e-01. acc. prob=0.88]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1220/1500 [00:04&lt;00:00, 316.30it/s, 15 steps of size 3.92e-01. acc. prob=0.88]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1258/1500 [00:04&lt;00:00, 331.45it/s, 15 steps of size 3.92e-01. acc. prob=0.88]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1292/1500 [00:04&lt;00:00, 326.75it/s, 15 steps of size 3.92e-01. acc. prob=0.88]sample:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 1326/1500 [00:05&lt;00:00, 330.09it/s, 7 steps of size 3.92e-01. acc. prob=0.88] sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1360/1500 [00:05&lt;00:00, 322.16it/s, 7 steps of size 3.92e-01. acc. prob=0.88]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1395/1500 [00:05&lt;00:00, 329.02it/s, 7 steps of size 3.92e-01. acc. prob=0.88]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1429/1500 [00:05&lt;00:00, 332.10it/s, 7 steps of size 3.92e-01. acc. prob=0.88]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1468/1500 [00:05&lt;00:00, 347.11it/s, 7 steps of size 3.92e-01. acc. prob=0.88]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:05&lt;00:00, 267.64it/s, 7 steps of size 3.92e-01. acc. prob=0.88]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   1%|          | 16/1500 [00:00&lt;00:10, 136.22it/s, 63 steps of size 1.16e-01. acc. prob=0.71]warmup:   2%|‚ñè         | 30/1500 [00:00&lt;00:11, 129.15it/s, 7 steps of size 2.55e-02. acc. prob=0.73] warmup:   3%|‚ñé         | 46/1500 [00:00&lt;00:10, 137.45it/s, 31 steps of size 4.85e-02. acc. prob=0.75]warmup:   4%|‚ñç         | 61/1500 [00:00&lt;00:10, 140.93it/s, 31 steps of size 6.16e-02. acc. prob=0.76]warmup:   5%|‚ñå         | 76/1500 [00:00&lt;00:10, 130.77it/s, 31 steps of size 9.18e-02. acc. prob=0.77]warmup:   6%|‚ñã         | 95/1500 [00:00&lt;00:09, 148.75it/s, 23 steps of size 1.85e-01. acc. prob=0.78]warmup:   7%|‚ñã         | 111/1500 [00:00&lt;00:10, 128.18it/s, 63 steps of size 1.23e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 125/1500 [00:00&lt;00:10, 125.63it/s, 31 steps of size 2.60e-01. acc. prob=0.78]warmup:   9%|‚ñâ         | 138/1500 [00:01&lt;00:11, 121.97it/s, 63 steps of size 9.95e-02. acc. prob=0.78]warmup:  10%|‚ñà         | 151/1500 [00:01&lt;00:13, 102.08it/s, 63 steps of size 1.26e+00. acc. prob=0.78]warmup:  12%|‚ñà‚ñè        | 175/1500 [00:01&lt;00:09, 134.66it/s, 7 steps of size 2.04e-01. acc. prob=0.78] warmup:  13%|‚ñà‚ñé        | 192/1500 [00:01&lt;00:09, 142.68it/s, 63 steps of size 2.59e-01. acc. prob=0.78]warmup:  14%|‚ñà‚ñç        | 217/1500 [00:01&lt;00:07, 167.58it/s, 31 steps of size 3.34e-01. acc. prob=0.78]warmup:  16%|‚ñà‚ñã        | 244/1500 [00:01&lt;00:06, 194.67it/s, 31 steps of size 2.60e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 265/1500 [00:01&lt;00:06, 187.19it/s, 15 steps of size 4.61e-01. acc. prob=0.78]warmup:  19%|‚ñà‚ñâ        | 291/1500 [00:01&lt;00:05, 206.74it/s, 7 steps of size 2.86e-01. acc. prob=0.78] warmup:  21%|‚ñà‚ñà        | 313/1500 [00:02&lt;00:06, 197.62it/s, 15 steps of size 4.91e-01. acc. prob=0.78]warmup:  23%|‚ñà‚ñà‚ñé       | 346/1500 [00:02&lt;00:04, 231.35it/s, 15 steps of size 5.94e-01. acc. prob=0.79]warmup:  25%|‚ñà‚ñà‚ñç       | 371/1500 [00:02&lt;00:04, 236.08it/s, 7 steps of size 3.51e-01. acc. prob=0.79] warmup:  27%|‚ñà‚ñà‚ñã       | 398/1500 [00:02&lt;00:04, 245.07it/s, 7 steps of size 3.67e-01. acc. prob=0.79]warmup:  29%|‚ñà‚ñà‚ñä       | 430/1500 [00:02&lt;00:04, 264.97it/s, 15 steps of size 4.51e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñà       | 457/1500 [00:02&lt;00:04, 258.42it/s, 15 steps of size 4.35e-01. acc. prob=0.79]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 484/1500 [00:02&lt;00:04, 233.42it/s, 7 steps of size 2.51e-01. acc. prob=0.79] sample:  34%|‚ñà‚ñà‚ñà‚ñç      | 514/1500 [00:02&lt;00:03, 250.66it/s, 7 steps of size 3.64e-01. acc. prob=0.85]sample:  36%|‚ñà‚ñà‚ñà‚ñå      | 542/1500 [00:02&lt;00:03, 258.61it/s, 7 steps of size 3.64e-01. acc. prob=0.84]sample:  38%|‚ñà‚ñà‚ñà‚ñä      | 571/1500 [00:02&lt;00:03, 265.73it/s, 15 steps of size 3.64e-01. acc. prob=0.83]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 606/1500 [00:03&lt;00:03, 286.82it/s, 15 steps of size 3.64e-01. acc. prob=0.85]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 635/1500 [00:03&lt;00:03, 283.82it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 664/1500 [00:03&lt;00:02, 285.00it/s, 7 steps of size 3.64e-01. acc. prob=0.86] sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 693/1500 [00:03&lt;00:02, 282.67it/s, 7 steps of size 3.64e-01. acc. prob=0.86]sample:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 726/1500 [00:03&lt;00:02, 293.36it/s, 15 steps of size 3.64e-01. acc. prob=0.85]sample:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 757/1500 [00:03&lt;00:02, 296.56it/s, 15 steps of size 3.64e-01. acc. prob=0.85]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 787/1500 [00:03&lt;00:02, 291.72it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 819/1500 [00:03&lt;00:02, 296.17it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 851/1500 [00:03&lt;00:02, 299.74it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 882/1500 [00:04&lt;00:02, 285.92it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 912/1500 [00:04&lt;00:02, 289.72it/s, 7 steps of size 3.64e-01. acc. prob=0.86] sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 944/1500 [00:04&lt;00:01, 295.24it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 974/1500 [00:04&lt;00:01, 287.37it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 1003/1500 [00:04&lt;00:01, 285.23it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1032/1500 [00:04&lt;00:01, 274.16it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 1060/1500 [00:04&lt;00:01, 275.56it/s, 7 steps of size 3.64e-01. acc. prob=0.86] sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1090/1500 [00:04&lt;00:01, 279.16it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 1121/1500 [00:04&lt;00:01, 284.58it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1155/1500 [00:04&lt;00:01, 299.32it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 1186/1500 [00:05&lt;00:01, 287.80it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1216/1500 [00:05&lt;00:00, 290.78it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 1246/1500 [00:05&lt;00:00, 280.33it/s, 7 steps of size 3.64e-01. acc. prob=0.86] sample:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1275/1500 [00:05&lt;00:00, 273.52it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1305/1500 [00:05&lt;00:00, 280.67it/s, 7 steps of size 3.64e-01. acc. prob=0.86] sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1335/1500 [00:05&lt;00:00, 282.91it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1364/1500 [00:05&lt;00:00, 269.94it/s, 15 steps of size 3.64e-01. acc. prob=0.86]sample:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 1392/1500 [00:05&lt;00:00, 264.09it/s, 15 steps of size 3.64e-01. acc. prob=0.87]sample:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1419/1500 [00:05&lt;00:00, 251.78it/s, 7 steps of size 3.64e-01. acc. prob=0.87] sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 1445/1500 [00:06&lt;00:00, 248.88it/s, 7 steps of size 3.64e-01. acc. prob=0.87]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1474/1500 [00:06&lt;00:00, 259.80it/s, 7 steps of size 3.64e-01. acc. prob=0.87]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:06&lt;00:00, 238.99it/s, 15 steps of size 3.64e-01. acc. prob=0.87]
  0%|          | 0/1500 [00:00&lt;?, ?it/s]warmup:   1%|          | 11/1500 [00:00&lt;00:13, 106.37it/s, 255 steps of size 3.18e-02. acc. prob=0.63]warmup:   1%|‚ñè         | 22/1500 [00:00&lt;00:14, 99.35it/s, 7 steps of size 2.26e-01. acc. prob=0.74]   warmup:   2%|‚ñè         | 33/1500 [00:00&lt;00:16, 90.72it/s, 127 steps of size 4.94e-02. acc. prob=0.74]warmup:   3%|‚ñé         | 45/1500 [00:00&lt;00:14, 97.53it/s, 63 steps of size 8.22e-02. acc. prob=0.76] warmup:   4%|‚ñç         | 63/1500 [00:00&lt;00:11, 123.65it/s, 7 steps of size 1.92e-01. acc. prob=0.77]warmup:   5%|‚ñå         | 76/1500 [00:00&lt;00:11, 119.56it/s, 31 steps of size 6.06e-02. acc. prob=0.77]warmup:   6%|‚ñã         | 95/1500 [00:00&lt;00:10, 139.81it/s, 15 steps of size 8.60e-02. acc. prob=0.77]warmup:   7%|‚ñã         | 110/1500 [00:00&lt;00:10, 138.40it/s, 31 steps of size 1.55e-01. acc. prob=0.77]warmup:   8%|‚ñä         | 125/1500 [00:00&lt;00:09, 140.94it/s, 63 steps of size 1.27e-01. acc. prob=0.77]warmup:  10%|‚ñâ         | 149/1500 [00:01&lt;00:07, 169.84it/s, 7 steps of size 3.83e-01. acc. prob=0.78] warmup:  11%|‚ñà‚ñè        | 169/1500 [00:01&lt;00:07, 170.90it/s, 63 steps of size 1.88e-01. acc. prob=0.78]warmup:  13%|‚ñà‚ñé        | 190/1500 [00:01&lt;00:07, 181.38it/s, 15 steps of size 3.49e-01. acc. prob=0.78]warmup:  15%|‚ñà‚ñç        | 219/1500 [00:01&lt;00:06, 211.29it/s, 15 steps of size 2.58e-01. acc. prob=0.78]warmup:  17%|‚ñà‚ñã        | 250/1500 [00:01&lt;00:05, 237.06it/s, 15 steps of size 3.50e-01. acc. prob=0.78]warmup:  18%|‚ñà‚ñä        | 274/1500 [00:01&lt;00:05, 205.77it/s, 7 steps of size 7.37e-01. acc. prob=0.78] warmup:  20%|‚ñà‚ñâ        | 296/1500 [00:01&lt;00:05, 208.97it/s, 15 steps of size 4.12e-01. acc. prob=0.78]warmup:  21%|‚ñà‚ñà‚ñè       | 322/1500 [00:01&lt;00:05, 221.87it/s, 7 steps of size 1.64e-01. acc. prob=0.78] warmup:  24%|‚ñà‚ñà‚ñé       | 353/1500 [00:01&lt;00:04, 246.04it/s, 7 steps of size 2.81e-01. acc. prob=0.78]warmup:  26%|‚ñà‚ñà‚ñå       | 385/1500 [00:02&lt;00:04, 263.85it/s, 31 steps of size 3.02e-01. acc. prob=0.78]warmup:  28%|‚ñà‚ñà‚ñä       | 417/1500 [00:02&lt;00:03, 278.42it/s, 15 steps of size 3.47e-01. acc. prob=0.79]warmup:  30%|‚ñà‚ñà‚ñâ       | 448/1500 [00:02&lt;00:03, 283.87it/s, 15 steps of size 4.07e-01. acc. prob=0.79]warmup:  32%|‚ñà‚ñà‚ñà‚ñè      | 477/1500 [00:02&lt;00:04, 244.23it/s, 31 steps of size 1.52e-01. acc. prob=0.78]sample:  34%|‚ñà‚ñà‚ñà‚ñé      | 503/1500 [00:02&lt;00:04, 236.29it/s, 15 steps of size 3.36e-01. acc. prob=0.95]sample:  35%|‚ñà‚ñà‚ñà‚ñå      | 528/1500 [00:02&lt;00:04, 236.09it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  37%|‚ñà‚ñà‚ñà‚ñã      | 554/1500 [00:02&lt;00:03, 240.68it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  39%|‚ñà‚ñà‚ñà‚ñä      | 580/1500 [00:02&lt;00:03, 245.10it/s, 15 steps of size 3.36e-01. acc. prob=0.91]sample:  40%|‚ñà‚ñà‚ñà‚ñà      | 606/1500 [00:02&lt;00:03, 249.24it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 632/1500 [00:03&lt;00:03, 246.58it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 657/1500 [00:03&lt;00:03, 240.81it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 683/1500 [00:03&lt;00:03, 243.73it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 708/1500 [00:03&lt;00:03, 244.36it/s, 7 steps of size 3.36e-01. acc. prob=0.92] sample:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 735/1500 [00:03&lt;00:03, 250.67it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 761/1500 [00:03&lt;00:03, 238.56it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 786/1500 [00:03&lt;00:02, 241.14it/s, 15 steps of size 3.36e-01. acc. prob=0.91]sample:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 811/1500 [00:03&lt;00:02, 233.84it/s, 15 steps of size 3.36e-01. acc. prob=0.91]sample:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 835/1500 [00:03&lt;00:02, 232.41it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 861/1500 [00:04&lt;00:02, 237.80it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 886/1500 [00:04&lt;00:02, 239.12it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 911/1500 [00:04&lt;00:02, 242.12it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 938/1500 [00:04&lt;00:02, 248.90it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 964/1500 [00:04&lt;00:02, 251.57it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 990/1500 [00:04&lt;00:02, 250.90it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 1016/1500 [00:04&lt;00:01, 250.21it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 1045/1500 [00:04&lt;00:01, 259.52it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 1071/1500 [00:04&lt;00:01, 259.03it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 1098/1500 [00:04&lt;00:01, 260.90it/s, 7 steps of size 3.36e-01. acc. prob=0.92] sample:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 1125/1500 [00:05&lt;00:01, 260.74it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 1152/1500 [00:05&lt;00:01, 260.38it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 1179/1500 [00:05&lt;00:01, 254.34it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 1205/1500 [00:05&lt;00:01, 252.72it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 1231/1500 [00:05&lt;00:01, 254.69it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 1257/1500 [00:05&lt;00:00, 246.32it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 1284/1500 [00:05&lt;00:00, 249.84it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 1310/1500 [00:05&lt;00:00, 247.98it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 1335/1500 [00:05&lt;00:00, 244.90it/s, 7 steps of size 3.36e-01. acc. prob=0.92] sample:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 1360/1500 [00:06&lt;00:00, 242.43it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 1387/1500 [00:06&lt;00:00, 248.34it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 1414/1500 [00:06&lt;00:00, 253.88it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 1441/1500 [00:06&lt;00:00, 256.46it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 1467/1500 [00:06&lt;00:00, 245.50it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 1492/1500 [00:06&lt;00:00, 240.82it/s, 15 steps of size 3.36e-01. acc. prob=0.92]sample: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1500/1500 [00:06&lt;00:00, 227.30it/s, 15 steps of size 3.36e-01. acc. prob=0.92]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                    mean       std    median      5.0%     95.0%     n_eff     r_hat
p_estimable[0]      0.66      0.13      0.67      0.45      0.89   1273.83      1.00
p_estimable[1]      0.86      0.09      0.88      0.74      0.99   2847.09      1.00
p_estimable[2]      0.88      0.06      0.89      0.78      0.97   3379.08      1.00
p_estimable[3]      0.87      0.06      0.88      0.79      0.97   3314.45      1.00
p_estimable[4]      0.90      0.05      0.91      0.82      0.98   3323.84      1.00
        phi[0]      0.72      0.13      0.72      0.55      0.99   2327.64      1.00
        phi[1]      0.45      0.07      0.45      0.34      0.57   3174.66      1.00
        phi[2]      0.48      0.06      0.48      0.38      0.58   3970.13      1.00
        phi[3]      0.63      0.06      0.63      0.53      0.73   4211.09      1.00
        phi[4]      0.60      0.06      0.60      0.51      0.70   3935.25      1.00
        phi[5]      0.53      0.05      0.53      0.45      0.60   4443.99      1.00
         pi[0]      0.07      0.01      0.07      0.05      0.09   4682.48      1.00
         pi[1]      0.24      0.05      0.23      0.15      0.32   1232.31      1.00
         pi[2]      0.15      0.04      0.15      0.08      0.22   1577.74      1.00
         pi[3]      0.15      0.03      0.15      0.10      0.19   3401.16      1.00
         pi[4]      0.13      0.03      0.13      0.09      0.17   3342.80      1.00
         pi[5]      0.15      0.02      0.15      0.11      0.19   3725.23      1.00
         pi[6]      0.11      0.02      0.11      0.08      0.15   4178.74      1.00
           psi      0.64      0.03      0.64      0.59      0.69   1789.99      1.00

Number of divergences: 0</code></pre>
</div>
</div>
<div id="cell-fig-trace-full" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> mcmc.get_samples(group_by_chain<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>idata <span class="op">=</span> az.from_dict(samples)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">'N'</span>] <span class="op">=</span> idata.posterior[<span class="st">'psi'</span>] <span class="op">*</span> MAX_ABUNDANCE</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>idata.posterior[<span class="st">'p'</span>] <span class="op">=</span> idata.posterior[<span class="st">'p_estimable'</span>]</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior means from table 10.1 in Royle and Dorazio (2008)</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>phi_royle <span class="op">=</span> [<span class="fl">0.741</span>, <span class="fl">0.454</span>, <span class="fl">0.481</span>, <span class="fl">0.628</span>, <span class="fl">0.602</span>, <span class="fl">0.526</span>]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>p_royle <span class="op">=</span> [<span class="fl">0.618</span>, <span class="fl">0.863</span>, <span class="fl">0.876</span>, <span class="fl">0.873</span>, <span class="fl">0.902</span>]</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>pi_royle <span class="op">=</span> [<span class="fl">0.068</span>, <span class="fl">0.263</span>, <span class="fl">0.135</span>, <span class="fl">0.146</span>, <span class="fl">0.132</span>, <span class="fl">0.145</span>, <span class="fl">0.111</span>]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>N_royle <span class="op">=</span> <span class="fl">326.5</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># generate traceplots for parameters</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> az.plot_trace(</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    idata,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    var_names<span class="op">=</span>[<span class="st">'N'</span>, <span class="st">'phi'</span>, <span class="st">'p'</span>, <span class="st">'pi'</span>],</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    labeller<span class="op">=</span>labeller,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    lines<span class="op">=</span>[(<span class="st">"phi"</span>, {}, phi_royle), (<span class="st">"p"</span>, {}, p_royle),</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>           (<span class="st">"pi"</span>, {}, pi_royle), (<span class="st">"N"</span>, {}, N_royle)],</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>row_count, _ <span class="op">=</span> ax.shape</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>[ax[i, <span class="dv">0</span>].grid(<span class="va">False</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(row_count)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="fig-trace-full" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trace-full-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="numpyro-js_files/figure-html/fig-trace-full-output-1.png" width="695" height="678" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trace-full-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Traceplots for full model of the dipper data.
</figcaption>
</figure>
</div>
</div>
</div>
<p>As we can see, the parameter estimates are very similar to that of <span class="citation" data-cites="royle2008">(<a href="#ref-royle2008" role="doc-biblioref">Royle and Dorazio 2008</a>)</span>. We can also plot survival over time, to compare with the <a href="./pymc-jssa.html">PyMC Jolly-Seber notebook</a>.</p>
<div id="a58f93c0" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> mcmc.get_samples(group_by_chain<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">1981</span>, <span class="dv">1987</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>phi_samples <span class="op">=</span> samples[<span class="st">'phi'</span>]</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>phi_median <span class="op">=</span> np.median(phi_samples, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>ax.plot(t, phi_median, linestyle<span class="op">=</span><span class="st">'dotted'</span>, color<span class="op">=</span><span class="st">'lightgray'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>ax.violinplot(phi_samples, t, showmedians<span class="op">=</span><span class="va">True</span>, showextrema<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'Apparent survival </span><span class="dv">$</span><span class="er">\</span><span class="vs">phi</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r'Dipper JSSA'</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="numpyro-js_files/figure-html/cell-16-output-1.png" width="584" height="381" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Here, I demonstrated how to estimate survival and abundance with Jolly-Seber models in NumPyro. To do so, I fit the model with the multi-state parameterization described in <span class="citation" data-cites="kery2011">K√©ry and Schaub (<a href="#ref-kery2011" role="doc-biblioref">2011</a>)</span>. This is virtually identical to the restricted occupancy parameterization of the model <span class="citation" data-cites="royle2008">(<a href="#ref-royle2008" role="doc-biblioref">Royle and Dorazio 2008</a>)</span>. The primary difference is also its downfall in BUGS, namely, its reliance on the Categorical distribution. As with the other NumPyro notebooks in this series, I skirted this problem with NumPyro‚Äôs automated marginalization (enumeration). As a result, a model that takes 32 minutes to fit in BUGS takes 11 seconds to fit here.</p>
<p>Of course, it would be even faster to fit the marginalized version of the model described in the <a href="./pymc-jssa.html">PyMC Jolly-Seber notebook</a>. Nevertheless, it is oftentimes more intuitive to specify the model in terms of the generating process, i.e., the <span class="math inline">\(z_{i,t}\)</span> state. Moreover, doing so facilitates fitting models with individual variation. As such, NumPyro‚Äôs automated enumeration provides the best of both worlds.</p>
<p>I focused on the multi-state parameterization because I was unable to find a way to fit the restricted occupancy or Schwarz-Arnason versions of the model in NumPyro. Both versions rely on accumulated <span class="math inline">\(z_{i,t}\)</span> state over time. As far as I can tell, the NumPyro enumeration procedure prohibits this. Users who are interested might open an issue with the NumPyro team.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-kery2011" class="csl-entry" role="listitem">
K√©ry, Marc, and Michael Schaub. 2011. <em>Bayesian Population Analysis Using WinBUGS: A Hierarchical Perspective</em>. Academic Press.
</div>
<div id="ref-royle2008" class="csl-entry" role="listitem">
Royle, J Andrew, and Robert M Dorazio. 2008. <em>Hierarchical Modeling and Inference in Ecology: The Analysis of Data from Populations, Metapopulations and Communities</em>. Elsevier.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./numpyro-occ.html" class="pagination-link" aria-label="Dynamic occupancy">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Dynamic occupancy</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./numpyro-cjs.html" class="pagination-link" aria-label="Cormack-Jolly-Seber">
        <span class="nav-page-text">Cormack-Jolly-Seber</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>